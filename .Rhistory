#means and vars @0
lV1 ~ 0*1; lV2 ~0*1; lV4 ~ 0*1; lV6 ~ 0*1
dV1 ~ 0*1; dV2 ~0*1; dV3 ~ 0*1
lV1 ~~ 0*lV1; lV2 ~~ 0*lV2; lV4 ~~ 0*lV4; lV6 ~~ 0*lV6
dV1 ~~ 0*dV1; dV2 ~~ 0*dV2; dV3 ~~ 0*dV3
#auVo-proportions
dV1 ~ beta*lV1; dV2 ~ beta*lV2; dV3 ~ beta*lV4;
#residuals equal
V1 ~~ resid*V1; V2 ~~ resid*V2; V4 ~~ resid*V4; V6 ~~ resid*V6;
"
fit.lds <- lavaan(lds_1, data=wisc)
summary(fit.lds,standardized=TRUE)
# problem with mult.start=TRUE
#################################### check out gradient ###########################33333
#mats = extractMatrices(fit.lds)
#model = fit.lds
#mm = extractMatrices(model)$A[,"1"]
#SampMean <- model@SampleStats@mean[][[1]]
#ss = match(names(mm[mm > 0]),model@Data@ov$name)
#SampMean[-c(ss)] = 0
#SampCov <- model@SampleStats@cov[][[1]]
#SampCov2 <- SampCov + SampMean%*%t(SampMean)
# try changing size of SampCov
#SampCov3 = cbind(SampCov2,SampMean)
#SampCov = rbind(SampCov3,append(SampMean,1))
#ImpCov = RAMmult(mats$parameters,mats$A,mats$S,mats$F,mats$A_fixed,mats$A_est,mats$S_fixed,mats$S_est)
#round(rcpp_grad_ram(mats$parameters, ImpCov$ImpCov, SampCov, mats$A_est, mats$S_est,
#              mats$A, mats$S, mats$F, lambda=0, type2=0, pen_vec=0, diff_par=0),3)
#m3 = fitted(fit.lds)$mean
#cov3 = fitted(fit.lds)$cov
#cov3 + m3 %*% t(m3)
#inspect(fit.lds,what="gradient")
######################################################################################
#starts <- c(1,19.8,.2,1.5,19.4,3,12.8)
#out <- regsem(fit.lds,optMethod="coord_desc",gradFun="ram",tol=1e-5,type="ridge",lambda=0.01,step=.1)
#summary(out)
out.cv <- cv_regsem(fit.lds,n.lambda=2,mult.start=TRUE,mult.iter=20,jump=.01,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-5,max.iter=100,step.ratio=FALSE,
alpha.inc=TRUE)
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=2,mult.start=TRUE,mult.iter=20,jump=.01,warm.start=TRUE,
t=TRUE,mult.iter=20,jump=.01,warm.start=TRUE,
out.cv <- cv_regsem(fit.lds,n.lambda=2,mult.start=TRUE,mult.iter=20,jump=.01,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-5,max.iter=100,step.ratio=FALSE,
alpha.inc=FALSE)
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=2,mult.start=TRUE,mult.iter=20,jump=.01,warm.start=TRUE,
type="scad", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-5,max.iter=100,step.ratio=FALSE,
alpha.inc=FALSE)
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=2,mult.start=TRUE,mult.iter=20,jump=.01,warm.start=TRUE,
type="lasso", gradFun = "numDeriv",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-5,max.iter=100,step.ratio=FALSE,
alpha.inc=FALSE)
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=2,mult.start=TRUE,mult.iter=20,jump=.01,warm.start=TRUE,
type="lasso", gradFun = "numDeriv",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-3,max.iter=100,step.ratio=FALSE,
alpha.inc=FALSE)
out.cv
library(regsem)
library(regsem)
out.cv <- cv_regsem(fit.lds,n.lambda=2,mult.start=TRUE,mult.iter=20,jump=.01,warm.start=TRUE,
type="lasso", gradFun = "numDeriv",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-3,max.iter=100,step.ratio=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
library(regsem)
out.cv <- cv_regsem(fit.lds,n.lambda=2,mult.start=TRUE,mult.iter=20,jump=.01,warm.start=TRUE,
type="lasso", gradFun = "numDeriv",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-3,max.iter=100,step.ratio=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=1,mult.start=TRUE,mult.iter=20,jump=.01,warm.start=TRUE,
type="none", gradFun = "numDeriv",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-3,max.iter=100,step.ratio=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out <- regsem(fit.lds,optMethod="coord_desc",gradFun="ram",tol=1e-5,type="none",lambda=0,step=.1)
#summary(out)
summary(out)
out <- regsem(fit.lds,optMethod="coord_desc",gradFun="ram",tol=1e-5,type="ridge",lambda=0,step=.1)
summary(out)
out <- regsem(fit.lds,optMethod="nlminb",gradFun="ram",tol=1e-5,type="ridge",lambda=0,step=.1)
summary(out)
out <- regsem(fit.lds,optMethod="nlminb",gradFun="ram",tol=1e-5,type="ridge",lambda=.1,step=.1,pars_pen=3)
summary(out)
out.cv <- cv_regsem(fit.lds,n.lambda=20,mult.start=TRUE,mult.iter=20,jump=.01,warm.start=TRUE,
type="ridge", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="nlminb",step=.1,tol=1e-3,max.iter=100,step.ratio=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=20,mult.start=TRUE,mult.iter=20,jump=.05,warm.start=TRUE,
type="ridge", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="nlminb",step=.1,tol=1e-3,max.iter=100,step.ratio=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
library(regsem)
out.cv <- cv_regsem(fit.lds,n.lambda=2,mult.start=TRUE,mult.iter=20,jump=.05,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-3,max.iter=100,step.ratio=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
library(regsem)
out.cv <- cv_regsem(fit.lds,n.lambda=2,mult.start=TRUE,mult.iter=20,jump=.05,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-3,max.iter=100,step.ratio=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
library(regsem)
out.cv <- cv_regsem(fit.lds,n.lambda=2,mult.start=TRUE,mult.iter=20,jump=.05,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=20,mult.start=TRUE,mult.iter=20,jump=.05,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=1,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=20,mult.start=TRUE,mult.iter=20,jump=.1,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=1,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=20,mult.start=TRUE,mult.iter=20,jump=.1,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=1,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=20,mult.start=TRUE,mult.iter=20,jump=1,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=1,tol=1e-5,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv <- cv_regsem(fit.lds,n.lambda=20,mult.start=TRUE,mult.iter=20,jump=1,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=1,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv <- cv_regsem(fit.lds,n.lambda=100,mult.start=TRUE,mult.iter=20,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=1,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv <- cv_regsem(fit.lds,n.lambda=100,mult.start=TRUE,mult.iter=20,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=1,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv <- cv_regsem(fit.lds,n.lambda=30,mult.start=TRUE,mult.iter=20,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=1,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=30,mult.start=TRUE,mult.iter=20,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=1,tol=1e-3,max.iter=100,step.ratio=FALSE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv <- cv_regsem(fit.lds,n.lambda=30,mult.start=TRUE,mult.iter=20,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.1,tol=1e-3,max.iter=100,step.ratio=FALSE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=30,mult.start=TRUE,mult.iter=20,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=50,mult.start=TRUE,mult.iter=20,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=35,mult.start=TRUE,mult.iter=20,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=1,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=35,mult.start=TRUE,mult.iter=20,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
lds_1 <- "
#latent variables
lV1 =~ 1*V1
lV2 =~ 1*V2
lV4 =~ 1*V4
lV6 =~ 1*V6
#autoregressions
lV2 ~ 1*lV1; lV4 ~ 1*lV2; lV6 ~ 1*lV4
#change - delta; d
dV1 =~ 1*lV2; dV2 =~ 1*lV4; dV3 =~ 1*lV6
#intercept and slope
inV =~ 1*lV1;
#slope =~ alpha*dV1 + alpha*dV2 + alpha*dV3
# match lgm
slope =~ 1*dV1 + 2*dV2 + 2*dV3
#slope =~ 1.17*dV1 + alpha1*dV2 + alpha2*dV3
#manifest means @0
V1 ~ 0*1; V2 ~0*1; V4 ~ 0*1; V6 ~ 0*1
#slope and intercept means
slope ~ 1;
inV ~ 1;
#Latent variances and covariance
slope ~~ slope;
inV ~~ inV;
slope ~~ inV;
#means and vars @0
lV1 ~ 0*1; lV2 ~0*1; lV4 ~ 0*1; lV6 ~ 0*1
dV1 ~ 0*1; dV2 ~0*1; dV3 ~ 0*1
lV1 ~~ 0*lV1; lV2 ~~ 0*lV2; lV4 ~~ 0*lV4; lV6 ~~ 0*lV6
dV1 ~~ 0*dV1; dV2 ~~ 0*dV2; dV3 ~~ 0*dV3
#auVo-proportions
dV1 ~ 0*lV1; dV2 ~ 0*lV2; dV3 ~ 0*lV4;
#residuals equal
V1 ~~ resid*V1; V2 ~~ resid*V2; V4 ~~ resid*V4; V6 ~~ resid*V6;
"
fit.lds <- lavaan(lds_1, data=wisc)
summary(fit.lds,standardized=TRUE)
lds_1 <- "
#latent variables
lV1 =~ 1*V1
lV2 =~ 1*V2
lV4 =~ 1*V4
lV6 =~ 1*V6
#autoregressions
lV2 ~ 1*lV1; lV4 ~ 1*lV2; lV6 ~ 1*lV4
#change - delta; d
dV1 =~ 1*lV2; dV2 =~ 1*lV4; dV3 =~ 1*lV6
#intercept and slope
inV =~ 1*lV1;
#slope =~ alpha*dV1 + alpha*dV2 + alpha*dV3
# match lgm
slope =~ 1*dV1 + 2*dV2 + 2*dV3
#slope =~ 1.17*dV1 + alpha1*dV2 + alpha2*dV3
#manifest means @0
V1 ~ 0*1; V2 ~0*1; V4 ~ 0*1; V6 ~ 0*1
#slope and intercept means
slope ~ 1;
inV ~ 1;
#Latent variances and covariance
slope ~~ slope;
inV ~~ inV;
slope ~~ inV;
#means and vars @0
lV1 ~ 0*1; lV2 ~0*1; lV4 ~ 0*1; lV6 ~ 0*1
dV1 ~ 0*1; dV2 ~0*1; dV3 ~ 0*1
lV1 ~~ 0*lV1; lV2 ~~ 0*lV2; lV4 ~~ 0*lV4; lV6 ~~ 0*lV6
dV1 ~~ 0*dV1; dV2 ~~ 0*dV2; dV3 ~~ 0*dV3
#auVo-proportions
dV1 ~ .3*lV1; dV2 ~ .3*lV2; dV3 ~ .3*lV4;
#residuals equal
V1 ~~ resid*V1; V2 ~~ resid*V2; V4 ~~ resid*V4; V6 ~~ resid*V6;
"
fit.lds <- lavaan(lds_1, data=wisc)
summary(fit.lds,standardized=TRUE)
fitmeasures(fit.lds)
lds_1 <- "
#latent variables
lV1 =~ 1*V1
lV2 =~ 1*V2
lV4 =~ 1*V4
lV6 =~ 1*V6
#autoregressions
lV2 ~ 1*lV1; lV4 ~ 1*lV2; lV6 ~ 1*lV4
#change - delta; d
dV1 =~ 1*lV2; dV2 =~ 1*lV4; dV3 =~ 1*lV6
#intercept and slope
inV =~ 1*lV1;
#slope =~ alpha*dV1 + alpha*dV2 + alpha*dV3
# match lgm
slope =~ 1*dV1 + 2*dV2 + 2*dV3
#slope =~ 1.17*dV1 + alpha1*dV2 + alpha2*dV3
#manifest means @0
V1 ~ 0*1; V2 ~0*1; V4 ~ 0*1; V6 ~ 0*1
#slope and intercept means
slope ~ 1;
inV ~ 1;
#Latent variances and covariance
slope ~~ slope;
inV ~~ inV;
slope ~~ inV;
#means and vars @0
lV1 ~ 0*1; lV2 ~0*1; lV4 ~ 0*1; lV6 ~ 0*1
dV1 ~ 0*1; dV2 ~0*1; dV3 ~ 0*1
lV1 ~~ 0*lV1; lV2 ~~ 0*lV2; lV4 ~~ 0*lV4; lV6 ~~ 0*lV6
dV1 ~~ 0*dV1; dV2 ~~ 0*dV2; dV3 ~~ 0*dV3
#auVo-proportions
dV1 ~ beta*lV1; dV2 ~ beta*lV2; dV3 ~ beta*lV4;
#residuals equal
V1 ~~ resid*V1; V2 ~~ resid*V2; V4 ~~ resid*V4; V6 ~~ resid*V6;
"
fit.lds <- lavaan(lds_1, data=wisc)
summary(fit.lds,standardized=TRUE)
out.cv <- cv_regsem(fit.lds,n.lambda=35,mult.start=TRUE,mult.iter=20,jump=.2,warm.start=TRUE,
type="scad", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=35,mult.start=TRUE,mult.iter=20,jump=1,warm.start=TRUE,
type="scad", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=100,mult.start=TRUE,mult.iter=20,jump=.1,warm.start=TRUE,
type="scad", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=100,mult.start=TRUE,mult.iter=20,jump=.1,warm.start=TRUE,
type="scad", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=120,mult.start=TRUE,mult.iter=20,jump=.1,warm.start=TRUE,
type="scad", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=120,mult.start=TRUE,mult.iter=20,jump=.1,warm.start=TRUE,
type="mcp", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=120,mult.start=TRUE,mult.iter=20,jump=.1,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv <- cv_regsem(fit.lds,n.lambda=30,mult.start=TRUE,mult.iter=50,jump=.1,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=30,mult.start=TRUE,mult.iter=50,jump=.1,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-2,max.iter=100,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=30,mult.start=TRUE,mult.iter=50,jump=.1,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=1,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=30,mult.start=TRUE,mult.iter=50,jump=.1,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=30,mult.start=TRUE,mult.iter=50,jump=.001,warm.start=TRUE,lambda.start=.4,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=30,mult.start=TRUE,mult.iter=50,jump=.001,warm.start=TRUE,lambda.start=.8,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=30,mult.start=TRUE,mult.iter=50,jump=.001,warm.start=TRUE,lambda.start=.8,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=300,step.ratio=TRUE,full=TRUE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv <- cv_regsem(fit.lds,n.lambda=25,mult.start=TRUE,mult.iter=50,jump=.001,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=25,mult.start=TRUE,mult.iter=50,jump=.1,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=25,mult.start=TRUE,mult.iter=50,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=50,mult.start=TRUE,mult.iter=50,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv <- cv_regsem(fit.lds,n.lambda=35,mult.start=TRUE,mult.iter=50,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=35,mult.start=TRUE,mult.iter=50,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-2,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=50,mult.start=TRUE,mult.iter=50,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-2,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=TRUE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=50,mult.start=TRUE,mult.iter=50,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-2,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=50,mult.start=TRUE,mult.iter=5,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=35,mult.start=TRUE,mult.iter=5,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "numDeriv",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=35,mult.start=TRUE,mult.iter=5,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-3,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
lds_1 <- "
#latent variables
lV1 =~ 1*V1
lV2 =~ 1*V2
lV4 =~ 1*V4
lV6 =~ 1*V6
#autoregressions
lV2 ~ 1*lV1; lV4 ~ 1*lV2; lV6 ~ 1*lV4
#change - delta; d
dV1 =~ 1*lV2; dV2 =~ 1*lV4; dV3 =~ 1*lV6
#intercept and slope
inV =~ 1*lV1;
#slope =~ alpha*dV1 + alpha*dV2 + alpha*dV3
# match lgm
slope =~ 1*dV1 + 2*dV2 + 2*dV3
#slope =~ 1.17*dV1 + alpha1*dV2 + alpha2*dV3
#manifest means @0
V1 ~ 0*1; V2 ~0*1; V4 ~ 0*1; V6 ~ 0*1
#slope and intercept means
slope ~ 1;
inV ~ 1;
#Latent variances and covariance
slope ~~ slope;
inV ~~ inV;
slope ~~ inV;
#means and vars @0
lV1 ~ 0*1; lV2 ~0*1; lV4 ~ 0*1; lV6 ~ 0*1
dV1 ~ 0*1; dV2 ~0*1; dV3 ~ 0*1
lV1 ~~ 0*lV1; lV2 ~~ 0*lV2; lV4 ~~ 0*lV4; lV6 ~~ 0*lV6
dV1 ~~ 0*dV1; dV2 ~~ 0*dV2; dV3 ~~ 0*dV3
#auVo-proportions
dV1 ~ .32*lV1; dV2 ~ .32*lV2; dV3 ~ .32*lV4;
#residuals equal
V1 ~~ resid*V1; V2 ~~ resid*V2; V4 ~~ resid*V4; V6 ~~ resid*V6;
"
fit.lds <- lavaan(lds_1, data=wisc)
summary(fit.lds,standardized=TRUE)
lds_1 <- "
#latent variables
lV1 =~ 1*V1
lV2 =~ 1*V2
lV4 =~ 1*V4
lV6 =~ 1*V6
#autoregressions
lV2 ~ 1*lV1; lV4 ~ 1*lV2; lV6 ~ 1*lV4
#change - delta; d
dV1 =~ 1*lV2; dV2 =~ 1*lV4; dV3 =~ 1*lV6
#intercept and slope
inV =~ 1*lV1;
#slope =~ alpha*dV1 + alpha*dV2 + alpha*dV3
# match lgm
slope =~ 1*dV1 + 2*dV2 + 2*dV3
#slope =~ 1.17*dV1 + alpha1*dV2 + alpha2*dV3
#manifest means @0
V1 ~ 0*1; V2 ~0*1; V4 ~ 0*1; V6 ~ 0*1
#slope and intercept means
slope ~ 1;
inV ~ 1;
#Latent variances and covariance
slope ~~ slope;
inV ~~ inV;
slope ~~ inV;
#means and vars @0
lV1 ~ 0*1; lV2 ~0*1; lV4 ~ 0*1; lV6 ~ 0*1
dV1 ~ 0*1; dV2 ~0*1; dV3 ~ 0*1
lV1 ~~ 0*lV1; lV2 ~~ 0*lV2; lV4 ~~ 0*lV4; lV6 ~~ 0*lV6
dV1 ~~ 0*dV1; dV2 ~~ 0*dV2; dV3 ~~ 0*dV3
#auVo-proportions
dV1 ~ beta*lV1; dV2 ~ beta*lV2; dV3 ~ beta*lV4;
#residuals equal
V1 ~~ resid*V1; V2 ~~ resid*V2; V4 ~~ resid*V4; V6 ~~ resid*V6;
"
fit.lds <- lavaan(lds_1, data=wisc)
summary(fit.lds,standardized=TRUE)
# problem with mult.start=TRUE
##################################
out.cv <- cv_regsem(fit.lds,n.lambda=35,mult.start=TRUE,mult.iter=5,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=20,mult.start=FALSE,mult.iter=5,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc="dec",par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=20,mult.start=FALSE,mult.iter=5,jump=.2,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,momentum=TRUE,par.lim=c(-20,30))
out.cv
out.cv <- cv_regsem(fit.lds,n.lambda=40,mult.start=FALSE,mult.iter=5,jump=.1,warm.start=TRUE,
type="lasso", gradFun = "ram",pars_pen=c(3),fit.ret=c("chisq","df","BIC"),
optMethod="coord_desc",step=.5,tol=1e-4,max.iter=300,step.ratio=TRUE,full=FALSE,
alpha.inc=FALSE,momentum=FALSE,par.lim=c(-20,30))
out.cv
