mypath = file.path("C:","R_Temp",paste("pred.poly.",i,".png", sep=""))
png(file = mypath)
myplot = ggplot(data.1, aes(x=apexpos, y=fsiq7)) + geom_point() +
stat_smooth(method='lm', formula = y ~ poly(x,i), size = 1) +
xlab('PHE Exposure') + ylab('Age 7 Full Scale IQ')
print(myplot)
dev.off()
r.square[i] = summary(lm.poly)$r.squared
adj.r.square[i] = summary(lm.poly)$adj.r.squared
mse[i] = mean(residuals(lm.poly)^2)
}
r.square
adj.r.square
mse
plot(r.square, ylab = 'R^2', xlab = 'Order of the Polynomial', ylim=c(0.5,1), xlim=c(1,20), type='l')
plot(adj.r.square, ylab = 'Adjusted R^2', xlab = 'Order of the Polynomial', ylim=c(0.5,1), xlim=c(1,20), type='l')
mypath = file.path("C:","R_Temp",paste("pred.poly.",i,".png", sep=""))
png(file = mypath)
for (i in 1:order) {
lm.poly <- lm(fsiq7 ~ poly(apexpos,i))
#     print(summary(lm.poly))
#mypath = file.path("C:","R_Temp",paste("pred.poly.",i,".png", sep=""))
#png(file = mypath)
myplot = ggplot(data.1, aes(x=apexpos, y=fsiq7)) + geom_point() +
stat_smooth(method='lm', formula = y ~ poly(x,i), size = 1) +
xlab('PHE Exposure') + ylab('Age 7 Full Scale IQ')
print(myplot)
dev.off()
r.square[i] = summary(lm.poly)$r.squared
adj.r.square[i] = summary(lm.poly)$adj.r.squared
mse[i] = mean(residuals(lm.poly)^2)
}
r.square
adj.r.square
mse
plot(r.square, ylab = 'R^2', xlab = 'Order of the Polynomial', ylim=c(0.5,1), xlim=c(1,20), type='l')
plot(adj.r.square, ylab = 'Adjusted R^2', xlab = 'Order of the Polynomial', ylim=c(0.5,1), xlim=c(1,20), type='l')
data.2<-data.1[sample(nrow(data.1)),]
K = 10
#Create 10 equally size folds
folds <- cut(seq(1,nrow(data.2)),breaks=K,labels=FALSE)
r.square = matrix(NA,K,order)
#Perform 10-fold cross validation
for(i in 1:K){
#Segement your data by fold using the which() function
testIndexes <- which(folds==i,arr.ind=TRUE)
testData <- data.2[testIndexes, ]
trainData <- data.2[-testIndexes, ]
#Use the test and train data partitions
for (j in 1:order){
fit.train = lm(fsiq7 ~ poly(apexpos,j), data = trainData)
fit.test = predict(fit.train, newdata=testData)
r.square[i,j] = cor(fit.test, testData$fsiq7, use='complete')^2
}
}
colMeans(r.square)
plot(colMeans(r.square), type='l')
# 10-fold CV leads to a fifth degree polynomial
myplot = ggplot(data.1, aes(x=apexpos, y=fsiq7)) + geom_point() +
stat_smooth(method='lm', formula = y ~ poly(x,5), size = 1) +
xlab('PHE Exposure') + ylab('Age 7 Full Scale IQ')
print(myplot)
lm.final = lm(fsiq7~poly(apexpos,5), data=data.1)
## Bring in Official Test Data ##
data.test = read.table('/Users/Ross/Google Drive/edm_book/ch1_intro/scripts/apexpos_test.dat')
names(data.test) = c('id', 'apexpos', 'fsiq7')
cor(data.test$fsiq7, predict(lm.final, newdata=data.test))^2
setwd("C:/Users/RJacobucci/Documents/GitHub/mimic_regsem")
setwd("C:/Users/Ross/Documents/GitHub/mimic_regsem")
setwd("C:/Users/jacobucc/Documents/GitHub/mimic_regsem")
library(lavaan)
library(qgraph)
library(semPlot)
library(psych)
library(regsem)
library(lmtest)
library(ggplot2)
library(reshape2)
library(semTools)
#datacamcan<-read.csv('CamCAN_cogneuro_data_Ross2017-03-16.csv')  #Reads in real data
datacamcan<-read.csv('schmamcandat2017-03-16.csv')
colnames(datacamcan)[3:50]<-print(paste('gm',1:48,sep=''))        #Unify grey matter labels for easier syntax
colnames(datacamcan)[51:98]<-print(paste('fa',1:48,sep=''))       #Unify grey matter labels for easier syntax
datacamcan$simpred1<-datacamcan$VSTMcolour_K_ss3+rnorm(708,.5,.5) #add dummy predictors for reference
datacamcan$simpred2<-datacamcan$VSTMcolour_K_ss3+rnorm(708,.5,.5) #add dummy predictors for reference
#Below the syntax to fit normal ML and regsem MIMIC models to predict a single LV (vstmlv) measured by three observables
#Syntax below is to use white matter (fa) and grey matter (gm) to predict a single LV.
#Total R^2 for FA predicting vstmlv is ~38% (versus 8% with noise), and ~27% for gm
#Most exciting would be to include both of course
# standardize variables
X = as.matrix(datacamcan[,99:101]),
cov = as.matrix(datacamcan[,51:98])
data.std <- data.frame(scale(datacamcan[,c(51:101)]))
#############Predicting VSTM: White matter (48 ROIS)
vstmCFA_WM<-'
vstmlv=~VSTMcolour_K_ss2+VSTMcolour_K_ss3+VSTMcolour_K_ss4
vstmlv~fa 1 +fa 2 +fa 3 +fa 4 +fa 5 +fa 6 +fa 7 +fa 8 +fa 9 +fa 10 +fa 11 +fa 12 +fa 13 +fa 14 +fa 15 +fa 16 +fa 17 +fa 18 +fa 19 +fa 20 +fa 21 +fa 22 +fa 23 +fa 24 +fa 25 +fa 26 +fa 27 +fa 28 +fa 29 +fa 30 +fa 31 +fa 32 +fa 33 +fa 34 +fa 35 +fa 36 +fa 37 +fa 38 +fa 39 +fa 40 +fa 41 +fa 42 +fa 43 +fa 44 +fa 45 +fa 46 +fa 47 +fa 48
'
fitvstm_WM <- cfa(vstmCFA_WM, data=data.std, estimator='mlr',missing='fiml')
summary(fitvstm_WM, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)
#regsem
lav.out_WM<-try(lavaan::sem(vstmCFA_WM,data.std,fixed.x=TRUE,meanstructure=FALSE),silent=TRUE)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=4,jump=.1,tol=1e-5,type="enet",pars_pen=c(3:50),quasi=FALSE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=4,jump=.1,tol=1e-5,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=40,jump=.1,tol=1e-5,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=.1,tol=1e-5,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out2_WM
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=.1,tol=1e-8,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=.1,tol=1e-8,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=.1,tol=1e-8,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=40,jump=.02,tol=1e-8,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM
library(regsem)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=40,jump=.02,tol=1e-8,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=20,jump=.02,tol=1e-8,type="lasso",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=20,jump=.05,tol=1e-8,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=.02,tol=1e-8,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=.02,tol=1e-4,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=.02,tol=1e-5,type="enet",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=.02,tol=1e-5,type="ridge",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM
plot(reg.out1_WM)
warnings()
library(regsem)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.02,tol=1e-5,type="ridge",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.02,tol=1e-5,type="ridge",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.1,tol=1e-5,type="ridge",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-5,type="ridge",pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-5,type="enet",alpha=0.8,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-5,type="enet",alpha=1,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-5,type="enet",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-5,type="enet",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-5,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
par
par=0.5
lambda1=0.5
lambda2=0.5
lambda1=0
lambda2=1
sign(par)*(max(abs(par)-(lambda1)/2,0)/(1+lambda2))
lambda=1
sign(par)*max(abs(par)-lambda,0)
lambda2=0
lambda1=1
sign(par)*(max(abs(par)-(lambda1)/2,0)/(1+lambda2))
lambda1=0.1
lambda=0.1
sign(par)*(max(abs(par)-(lambda1)/2,0)/(1+lambda2))
sign(par)*max(abs(par)-lambda,0)
sign(par)*max(abs(par)-lambda/2,0)
sign(par)*(max(abs(par)-(lambda1)/2,0)/(1+lambda2))
library(regsem)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-5,type="enet",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-5,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-8,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-6,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.05,tol=1e-6,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
reg.out1_WM
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-8,type="enet",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-8,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=1,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM
dim(reg.out1_WM[[1]])
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=TRUE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM
library(regsem)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
library(regsem)
library(regsem)
library(regsem)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="lasso",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=.1,tol=1e-6,type="enet",alpha=0.5,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-6,type="enet",alpha=1,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-6,type="ridge",alpha=1,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
plot(reg.out1_WM)
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-6,type="ridge",alpha=1,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-6,type="ridge",alpha=1,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=.1,tol=1e-6,type="ridge",alpha=1,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
library(regsem)
summary(reg.out1_WM)
summary(reg.out1_WM)
summary(reg.out1_WM)
reg.out1_WM
print(reg.out1_WM)
library(regsem)
print(reg.out1_WM)
summary(reg.out1_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=.1,tol=1e-6,type="ridge",alpha=1,pars_pen=c(3:50),quasi=TRUE,
fit.ret=c("Fmin","chisq","ncp","BIC","rmsea"),fit.ret2="train",
mult.start=FALSE,solver=FALSE,hessFun="none")
summary(reg.out1_WM)
summary.cvregsem(reg.out1_WM)
?summary
library(regsem)
summary(reg.out1_WM)
summary.cvregsem(reg.out1_WM)
?summary.cvregsem
library(regsem)
summary(reg.out1_WM)
reg.out1_WM[[2]]
summary(reg.out1_WM)
library(regsem)
summary(reg.out1_WM)
print(reg.out1_WM)
print(summary(reg.out1_WM))
summary(reg.out1_WM)
summary(reg.out1_WM)
library(regsem)
summary(reg.out1_WM)
summary(reg.out1_WM)
summary(reg.out1_WM)
library(regsem)
summary(reg.out1_WM)
summary(reg.out1_WM)
summary(reg.out1_WM)
summary(reg.out1_WM)
summary(reg.out1_WM)
library(regsem)
summary(reg.out1_WM)
