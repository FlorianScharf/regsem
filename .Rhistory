bcfa.lasso <- bcfa(mod11,data=HS,dp=dpriors(lambda="ddexp(0,100)")
jagcontrol=list(method="rjparallel",psrf.target = 1.2,max.time="1m"))
bcfa.lasso <- bcfa(mod11,data=HS,dp=dpriors(lambda="ddexp(0,100)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,max.time="1m"))
summary(bcfa.lasso)
bcfa.lasso <- bcfa(mod11,data=HS,dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,max.time="1m"))
summary(bcfa.lasso)
mod11 <- '
f =~ NA*x1 + prior("ddexp(0,20)")*x1 +
prior("ddexp(0,20)")*x2 + prior("ddexp(0,20)")*x3 +
prior("dnorm(0,10)")*x4 +
prior("dnorm(0,10)")*x5 +
prior("dnorm(0,10)")*x6
f~~1*f
x1~1
x2~1
x3~1
x4~1
x5~1
x6~1'
bcfa.lasso <- bcfa(mod11,data=HS,#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,max.time="1m"))
mod11 <- '
f =~ NA*x1 + prior("ddexp(0,40)")*x1 +
prior("ddexp(0,40)")*x2 + prior("ddexp(0,40)")*x3 +
prior("dnorm(0,10)")*x4 +
prior("dnorm(0,10)")*x5 +
prior("dnorm(0,10)")*x6
f~~1*f
x1~1
x2~1
x3~1
x4~1
x5~1
x6~1'
bcfa.lasso <- bcfa(mod11,data=HS,#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,max.time="1m"))
load("C:/Users/RJacobucci/Documents/GitHub/regsem/lavExport/semjags.rda")
init.list
str(jagtrans)
jagtrans$inits
inits <- jagtans$inits
inits <- jagtrans$inits
inits$c1$lambda
inits$c1$lambda <- rep(0.2,6)
inits$c2$lambda <- rep(0.4,6)
inits$c3$lambda <- rep(0.6,6)
?autorun.jags
bcfa.lasso <- bcfa(mod11,data=HS,#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,
max.time="1m",inits=inits))
inits
inits$c1$lambda <- matrix(rep(0.2,6),6,1)
inits$c2$lambda <- matrix(rep(0.4,6),6,1)
inits$c3$lambda <- matrix(rep(0.6,6),6,1)
inits
bcfa.lasso <- bcfa(mod11,data=HS,#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,
max.time="1m",inits=inits))
str(inits)
str(jagtrans$inits)
jagtrans$model
data <- jagtrans$data
model <- "
model {
for(i in 1:N) {
for(j in 1:6) {
y[i,j] ~ dnorm(mu[i,j],invtheta[j,g[i]])
}
mu[i,1] <- nu[1,g[i]] + lambda[1,g[i]]*eta[i,1]
mu[i,2] <- nu[2,g[i]] + lambda[2,g[i]]*eta[i,1]
mu[i,3] <- nu[3,g[i]] + lambda[3,g[i]]*eta[i,1]
mu[i,4] <- nu[4,g[i]] + lambda[4,g[i]]*eta[i,1]
mu[i,5] <- nu[5,g[i]] + lambda[5,g[i]]*eta[i,1]
mu[i,6] <- nu[6,g[i]] + lambda[6,g[i]]*eta[i,1]
# lvs
eta[i,1] ~ dnorm(mu.eta[i,1], invpsistar[1,g[i]])
mu.eta[i,1] <- alpha[1,g[i]]
}
# Priors/constraints
nu[1,1] ~ dnorm(0,1e-3)
lambda[1,1] ~ ddexp(0,40)
nu[2,1] ~ dnorm(0,1e-3)
lambda[2,1] ~ ddexp(0,40)
nu[3,1] ~ dnorm(0,1e-3)
lambda[3,1] ~ ddexp(0,40)
nu[4,1] ~ dnorm(0,1e-3)
lambda[4,1] ~ dnorm(0,10)
nu[5,1] ~ dnorm(0,1e-3)
lambda[5,1] ~ dnorm(0,10)
nu[6,1] ~ dnorm(0,1e-3)
lambda[6,1] ~ dnorm(0,10)
alpha[1,1] <- 0
invtheta[1,1] ~ dgamma(1,.5)
invtheta[2,1] ~ dgamma(1,.5)
invtheta[3,1] ~ dgamma(1,.5)
invtheta[4,1] ~ dgamma(1,.5)
invtheta[5,1] ~ dgamma(1,.5)
invtheta[6,1] ~ dgamma(1,.5)
for(j in 1:6) {
for(k in 1:1) {
theta[j,k] <- 1/invtheta[j,k]
}
}
invpsi[1,1] <- 1
for(j in 1:1) {
for(k in 1:1) {
psi[j,k] <- 1/invpsi[j,k]
}
}
# variances & covariances
invpsistar[1,1] <- 1/(psi[1,1])
} # End of model
"
data <- jagtrans$data
out <- autorun.jags(model=model,data=data,n.chains=3,method="rjparallel",
monitor=c("lambda"),
inits=inits,psrf.target=1.1)
bcfa.lasso <- bcfa(mod11,data=HS,#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,
max.time="1m",inits=jagtrans$inits))
bcfa.lasso <- bcfa(mod11,data=HS,inits=jagtrans$inits,#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,
max.time="1m"))
?bcfa
bcfa.lasso <- bcfa(mod11,data=HS,inits=inits,#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,
max.time="1m"))
warnings()
mod11 <- '
f =~ NA*x1 + x2 + x3 + x4 + x5 + x6
f~~1*f
x1~1
x2~1
x3~1
x4~1
x5~1
x6~1'
bcfa.lasso <- bcfa(mod11,data=HS,inits=inits,dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,
max.time="1m"))
bcfa.lasso <- bcfa(mod11,data=HS,inits="simple",dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,
max.time="1m"))
mod11 <- '
f =~ NA*x1 + prior("ddexp(0,40)")*x1 +
prior("ddexp(0,40)")*x2 + prior("ddexp(0,40)")*x3 +
x4 +
x5 +
x6
f~~1*f
x1~1
x2~1
x3~1
x4~1
x5~1
x6~1'
#mod11 <- '
#f =~ NA*x1 + x2 + x3 + x4 + x5 + x6
#f~~1*f
#x1~1
#x2~1
#x3~1
#x4~1
#x5~1
#x6~1'
bcfa.lasso <- bcfa(mod11,data=HS,inits="simple",#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,
max.time="1m"))
summary(bcfa.lasso)
mod22 <- '
f =~ NA*x1 + prior("dnorm(0,40)")*x1 +
prior("dnorm(0,40)")*x2 + prior("dnorm(0,40)")*x3 +
x4 +
x5 +
x6
f~~1*f
x1~1
x2~1
x3~1
x4~1
x5~1
x6~1'
bcfa.ridge <- bcfa(mod,data=HS,#dp=dpriors(lambda="dnorm(0,20)"),
jagcontrol=list(method="rjparallel"))
summary(bcfa.ridge)
bcfa.ridge <- bcfa(mod22,data=HS,#dp=dpriors(lambda="dnorm(0,20)"),
jagcontrol=list(method="rjparallel"))
summary(bcfa.ridge)
summary(bcfa.lasso)
library(modeest)
install.packages("modeest")
library(modeest)
bcfa.lasso <- bcfa(mod11,data=HS,inits="simple",#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,
mode.continuous=TRUE))
summary(bcfa.lasso)
bcfa.lasso <- bcfa(mod11,data=HS,#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,
mode.continuous=TRUE))
bcfa.lasso <- blavaan(mod11,data=HS,inits="simple",#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2,
mode.continuous=TRUE))
bcfa.lasso <- bcfa(mod11,data=HS,inits="simple",#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2),
runjags.options(mode.continuous=TRUE))
summary(bcfa.lasso,postmedian=TRUE, postmode=TRUE)
fitmeasures(bcfa.ridge)
fitmeasures(bcfa.lasso)
mod2 <- '
f =~ NA*x1 + prior("ddexp(0,100)")*x1 +
prior("ddexp(0,100)")*x2 + prior("ddexp(0,100)")*x3 +
x4 +
x5 +
x6
f~~1*f
x1~1
x2~1
x3~1
x4~1
x5~1
x6~1'
bcfa.lasso2 <- bcfa(mod2,data=HS,inits="simple",#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2),
runjags.options(mode.continuous=TRUE))
summary(bcfa.lasso2,postmedian=TRUE, postmode=TRUE)
mod2 <- '
f =~ NA*x1 + prior("ddexp(0,150)")*x1 +
prior("ddexp(0,150)")*x2 + prior("ddexp(0,150)")*x3 +
x4 +
x5 +
x6
f~~1*f
x1~1
x2~1
x3~1
x4~1
x5~1
x6~1'
bcfa.lasso2 <- bcfa(mod2,data=HS,inits="simple",#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2),
runjags.options(mode.continuous=TRUE))
summary(bcfa.lasso2,postmedian=TRUE, postmode=TRUE)
mod2 <- '
f =~ NA*x1 + prior("ddexp(0,300)")*x1 +
prior("ddexp(0,300)")*x2 + prior("ddexp(0,300)")*x3 +
x4 +
x5 +
x6
f~~1*f
x1~1
x2~1
x3~1
x4~1
x5~1
x6~1'
bcfa.lasso2 <- bcfa(mod2,data=HS,inits="simple",#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2),
runjags.options(mode.continuous=TRUE))
summary(bcfa.lasso2,postmedian=TRUE, postmode=TRUE)
summary(bcfa.lasso,postmedian=TRUE, postmode=TRUE)
lasso.out <- multi_optim(lav.out,max.try=100,lambda=0.015,type="lasso")
summary(lasso.out)
lasso.out <- multi_optim(lav.out,max.try=100,lambda=0.03,type="lasso")
summary(lasso.out)
lasso.out <- multi_optim(lav.out,max.try=100,lambda=0.3,type="lasso")
summary(lasso.out)
lasso.out <- multi_optim(lav.out,max.try=100,lambda=0.03,type="lasso",pars_pen=c(1:3))
summary(lasso.out)
lasso.out <- multi_optim(lav.out,max.try=100,lambda=0.1,type="lasso",pars_pen=c(1:3))
summary(lasso.out)
lasso.out <- multi_optim(lav.out,max.try=100,lambda=0.15,type="lasso",pars_pen=c(1:3))
summary(lasso.out)
lasso.out <- multi_optim(lav.out,max.try=100,lambda=0.13,type="lasso",pars_pen=c(1:3))
summary(lasso.out)
summary(bcfa.lasso,postmedian=TRUE, postmode=TRUE)
?bcfa
fitmeasures(bcfa.lasso)
summary(lasso.out)
lasso.out <- multi_optim(lav.out,max.try=100,lambda=0.135,type="lasso",pars_pen=c(1:3))
summary(lasso.out)
# lasso
lasso.out <- multi_optim(lav.out,max.try=100,lambda=0.135,type="lasso",pars_pen=c(1:3))
summary(lasso.out)
fitmeasures(bcfa.lasso)
lasso.out <- multi_optim(lav.out,max.try=100,lambda=0.128,type="lasso",pars_pen=c(1:3))
summary(lasso.out)
lasso.out <- multi_optim(lav.out,max.try=100,lambda=0.125,type="lasso",pars_pen=c(1:3))
summary(lasso.out)
fitmeasures(bcfa.lasso)
summary(bcfa.lasso,postmedian=TRUE, postmode=TRUE)
summary(lasso.out)
mod22 <- '
f =~ NA*x1 + prior("dnorm(0,100)")*x1 +
prior("dnorm(0,100)")*x2 + prior("dnorm(0,100)")*x3 +
x4 +
x5 +
x6
f~~1*f
x1~1
x2~1
x3~1
x4~1
x5~1
x6~1'
bcfa.ridge <- bcfa(mod22,data=HS,inits="simple",
jagcontrol=list(method="rjparallel"))
summary(bcfa.ridge)
fitmeasures(bcfa.ridge)
ridge.out <- multi_optim(lav.out,max.try=100,lambda=0.125,type="ridge",gradFun="none")
summary(ridge.out)
ridge.out <- multi_optim(lav.out,max.try=100,lambda=0.125,type="ridge",gradFun="none",pars_pen=c(1:3))
summary(ridge.out)
summary(lasso.out)
summary(bcfa.lasso,postmedian=TRUE, postmode=TRUE)
mod2 <- '
f =~ NA*x1 + prior("ddexp(0,80)")*x1 +
prior("ddexp(0,80)")*x2 + prior("ddexp(0,80)")*x3 +
x4 +
x5 +
x6
f~~1*f
x1~1
x2~1
x3~1
x4~1
x5~1
x6~1'
bcfa.lasso2 <- bcfa(mod2,data=HS,inits="simple",#dp=dpriors(lambda="ddexp(0,10)"),
jagcontrol=list(method="rjparallel",psrf.target = 1.2),
runjags.options(mode.continuous=TRUE))
summary(bcfa.lasso2,postmedian=TRUE, postmode=TRUE)
lasso.out2 <- multi_optim(lav.out,max.try=100,lambda=0.25,type="lasso",pars_pen=c(1:3))
summary(lasso.out2)
lasso.out2 <- multi_optim(lav.out,max.try=100,lambda=0.25,type="lasso",pars_pen=c(1:3))
summary(lasso.out2)
fitmeasures(bcfa.lasso2)
1/40
.025**2
lasso.out2 <- multi_optim(lav.out,max.try=100,lambda=0.28,type="lasso",pars_pen=c(1:3))
summary(lasso.out2)
mod22 <- '
f =~ NA*x1 + prior("dnorm(0,100)")*x1 +
prior("dnorm(0,100)")*x2 + prior("dnorm(0,100)")*x3 +
x4 +
x5 +
x6
f~~1*f
x1~1
x2~1
x3~1
x4~1
x5~1
x6~1'
bcfa.ridge <- bcfa(mod22,data=HS,inits="simple",
jagcontrol=list(method="rjparallel"))
summary(bcfa.ridge)
fitmeasures(bcfa.ridge)
ridge.out <- multi_optim(lav.out,max.try=100,lambda=0.125,type="ridge",gradFun="none",pars_pen=c(1:3))
summary(ridge.out)
ridge.out2 <- multi_optim(lav.out,max.try=100,lambda=0.250,
type="ridge",gradFun="none",pars_pen=c(1:3))
summary(ridge.out2)
(1/.005**2)/(301/2)
(1/.25**2)/(301/2)
ridge.out2 <- multi_optim(lav.out,max.try=100,lambda=0.337,
type="ridge",gradFun="none",pars_pen=c(1:3))
summary(ridge.out2)
ridge.out2 <- multi_optim(lav.out,max.try=100,lambda=0.337**2,
type="ridge",gradFun="none",pars_pen=c(1:3))
summary(ridge.out2)
ridge.out2 <- multi_optim(lav.out,max.try=100,lambda=0.28,
type="ridge",gradFun="none",pars_pen=c(1:3))
summary(ridge.out2)
ridge.out2 <- multi_optim(lav.out,max.try=100,lambda=0.2,
type="ridge",gradFun="none",pars_pen=c(1:3))
summary(ridge.out2)
ridge.out2 <- multi_optim(lav.out,max.try=100,lambda=0.195,
type="ridge",gradFun="none",pars_pen=c(1:3))
summary(ridge.out2)
mod3 <- '
f =~ NA*x1 + prior("dnorm(0,200)")*x1 + prior("dnorm(0,200)")*x2 + prior("dnorm(0,200)")*x3 +
x4 + x5 + x6
f~~1*f'
bcfa.ridge2 <- bcfa(mod3,data=HS,inits="simple",
jagcontrol=list(method="rjparallel",psrf.target = 1.2))
summary(bcfa.ridge2)
fitmeasures(bcfa.ridge2)
.195**2
.125**2
.0156*2
(1/.005**2)/(301/2)
(1/.005)/(301/2)
library(blavaan);library(modeest);library(regsem)
mod <- "
f =~ 0*x1 + 0*x2 + 0*x3 + 0.5*x4 + 0.5*x5 + 0.5*x6
f~~1*f"
dat <- simulateData(mod,model.type="cfa",sample.nobs=200)
mod.run <- "
f =~ NA*x1 + x2 + x3 + x4 + x5 + x6
f~~1*f
"
lav.out <- cfa(mod.run,dat,meanstructure=TRUE)
summary(lav.out)
set.seed(1234)
dat <- simulateData(mod,model.type="cfa",sample.nobs=200)
f =~ NA*x1 + x2 + x3 + x4 + x5 + x6
mod.run <- "
f~~1*f
"
lav.out <- cfa(mod.run,dat,meanstructure=TRUE)
mod <- "
f =~ 0*x1 + 0*x2 + 0*x3 + 0.5*x4 + 0.5*x5 + 0.5*x6
f~~1*f"
set.seed(1234)
dat <- simulateData(mod,model.type="cfa",sample.nobs=200)
mod.run <- "
f =~ NA*x1 + x2 + x3 + x4 + x5 + x6
f~~1*f
"
lav.out <- cfa(mod.run,dat,meanstructure=TRUE)
summary(lav.out)
?cv_regsem
cv.out <- cv_regsem(lav.out,n.lambda=50,jump=0.001,type="lasso")
cv.out
cv.out <- cv_regsem(lav.out,n.lambda=50,jump=0.002,type="lasso")
cv.out
cv.out <- cv_regsem(lav.out,n.lambda=50,jump=0.002,type="lasso",tol=1e-6)
cv.out
cv.out <- cv_regsem(lav.out,n.lambda=50,jump=0.002,type="lasso",tol=1e-6,pars_pen=c(1:3))
cv.out <- cv_regsem(lav.out,n.lambda=25,jump=0.002,type="lasso",tol=1e-6,pars_pen=c(1:3))
cv.out
cv.out <- cv_regsem(lav.out,n.lambda=25,jump=0.02,type="lasso",tol=1e-6,pars_pen=c(1:3))
cv.out
cv.out <- cv_regsem(lav.out,n.lambda=25,jump=0.005,type="lasso",tol=1e-6,pars_pen=c(1:3))
cv.out
mod.run <- "
f =~ NA*x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9
f~~1*f
"
lav.out <- cfa(mod.run,HolzingerSwineford1939,meanstructure=TRUE)
summary(lav.out)
cv.out <- cv_regsem(lav.out,n.lambda=50,jump=0.005,type="lasso",tol=1e-6,pars_pen=c(1:3,7:9))
cv.out
coef.mat <- abs(cv.out[[1]][c(1:3,7:9)])
coef.mat
coef.mat <- abs(cv.out[[1]][c(1:3,7:9),])
coef.mat <- abs(cv.out[[1]][,c(1:3,7:9)])
coef.mat
coef.mat <- abs(cv.out[[1]][,c(1:3,7:9)])
plot(coef.mat[,1],ylim=c(0,1),xlab="L1 Norm",ylab="Coefficient",type="l",xaxt="n",lty=1)
for(i in 2:(6)){
lines(coef.mat[,i],lty=lin[i])
#points(mat[,(nload)])
}
plot(coef.mat[,1],ylim=c(0,1),xlab="L1 Norm",ylab="Coefficient",type="l",xaxt="n",lty=1)
for(i in 2:(6)){
lines(coef.mat[,i],lty=[i])
#points(mat[,(nload)])
}
coef.mat <- abs(cv.out[[1]][,c(1:3,7:9)])
plot(coef.mat[,1],ylim=c(0,1),xlab="L1 Norm",ylab="Coefficient",type="l",xaxt="n",lty=1)
for(i in 2:(6)){
lines(coef.mat[,i],lty=[i])
#points(mat[,(nload)])
coef.mat <- abs(cv.out[[1]][,c(1:3,7:9)])
plot(coef.mat[,1],ylim=c(0,1),xlab="L1 Norm",ylab="Coefficient",type="l",xaxt="n",lty=1)
for(i in 2:(6)){
lines(coef.mat[,i],lty=i)
#points(mat[,(nload)])
}
abline(a=0,b=0)
coef.mat
coef.mat <- abs(cv.out[[1]][,c(1:3,7:9)])
plot(coef.mat[,1],ylim=c(0,.6),xlab="L1 Norm",ylab="Coefficient",type="l",xaxt="n",lty=1)
for(i in 2:(6)){
lines(coef.mat[,i],lty=i)
#points(mat[,(nload)])
}
abline(a=0,b=0)
coef.mat/coef.mat[1,]
for(i in 1:6){
coef.mat[,i] <- coef.mat[,i]/coef.mat[1,i]
}
coef.mat
coef.mat <- abs(cv.out[[1]][,c(1:3,7:9)])
coef.mat
cv.out <- cv_regsem(lav.out,n.lambda=60,jump=0.005,type="lasso",tol=1e-6,pars_pen=c(1:3,7:9))
cv.out
?cv_regsem
library(snowfall)
?seq
seq(0,by=0.002,length.out=50)
seq(0,by=jump,length.out=n.lambda)
lambdas <- seq(0,by=jump,length.out=n.lambda)
library(regsem); library(blavaan);library(modeest)
HS <- data.frame(scale(HolzingerSwineford1939[,7:12]))
#HS <- HolzingerSwineford1939[,7:12]
mod <- "
f =~ NA*x1 + x2 + x3 + x4 + x5 + x6
f~~1*f"
lav.out <- cfa(mod, HS,meanstructure=TRUE)
summary(lav.out)
ridge.out <- multi_optim(lav.out,max.try=100,lambda=0.125,type="ridge",gradFun="none",pars_pen=c(1:3))
summary(ridge.out)
summary(lav.out)
fitmeasures(lav.out)
summary(ridge.out)
ridge.out2 <- multi_optim(lav.out,max.try=100,lambda=0.195,
type="ridge",gradFun="none",pars_pen=c(1:3))
summary(ridge.out2)
