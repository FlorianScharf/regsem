M1 ~ a1*X
M2 ~ a2*X
M3 ~ a3*X
M4 ~ a4*X
M5 ~ a5*X
Y ~ b1*M1 + b2*M2 + b3*M3 + b4*M4 + b5*M5
# indirect effect (a*b)
a1b1 := a1*b1
a2b2 := a2*b2
a3b3 := a3*b3
a4b4 := a4*b4
a5b5 := a5*b5
# total effect
total := c + (a1*b1) + (a2*b2) + (a3*b3) + (a4*b4) + (a5*b5)
'
fit.delta = fit.cv.delta =  fit.reg =  Data = vector("list", reps)
i=1
X <- rnorm(N)
M1 <- .59*X + rnorm(N)
M2 <- .36*X + rnorm(N)
M3 <- .11*X + rnorm(N)
M4 <- rnorm(N)
M5 <- rnorm(N)
Y <- .59*M1 + .36*M2 + .11*M3 + rnorm(N)
Data[[i]] <- data.frame(X=X, Y=Y, M1=M1, M2=M2, M3=M3, M4=M4, M5=M5)
fit.delta[[i]] = sem(model,data=Data[[i]],meanstructure=TRUE,fixed.x=T)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=200,
n.lambda=100,tol=1e-6,fit.ret="chisq",fit.ret2="boot",parallel=FALSE)
Data
fit.delta[[i]] = sem(model,data=Data[[i]],meanstructure=FALSE,fixed.x=T)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=200,
n.lambda=100,tol=1e-6,fit.ret="chisq",fit.ret2="boot",parallel=FALSE)
warnings()
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=T,
n.lambda=100,tol=1e-6,fit.ret="chisq",fit.ret2="boot",parallel=FALSE)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=T,
n.lambda=100,tol=1e-6,fit.ret="chisq",fit.ret2="boot",parallel=FALSE,solver=TRUE)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.002,multi.iter=20,mult.start=T,
n.lambda=40,tol=1e-5,fit.ret="chisq",fit.ret2="boot",parallel=FALSE,solver=TRUE)
fit.cv.delta
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=T,
n.lambda=30,tol=1e-5,fit.ret="chisq",fit.ret2="boot",parallel=FALSE,solver=FALSE)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=T,
n.lambda=30,tol=1e-5,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=T,
n.lambda=30,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=T,
n.lambda=30,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=T,
n.lambda=30,tol=1e-2,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE)
fit.cv.delta[[1]]
?cv_regsem
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=T,
n.lambda=30,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.5)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=T,
n.lambda=30,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.01)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=T,
n.lambda=30,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.05)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.005,multi.iter=20,mult.start=T,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.01)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.005,multi.iter=20,mult.start=T,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.01)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.005,multi.iter=20,mult.start=T,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="boot",parallel=FALSE,solver=FALSE,step=0.01)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.005,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="boot",parallel=FALSE,solver=FALSE,step=0.01)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.005,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="boot",parallel=FALSE,solver=FALSE,step=0.05)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.005,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="boot",parallel=FALSE,solver=FALSE,step=0.02)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.005,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.02)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.5)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.5)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.5,warm.start=FALSE)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.5,warm.start=FALSE)
fit.cv.delta[[1]]
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.5)
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.5)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.01)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.01)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.005,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.01)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.007,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.01)
library(regsem)
fit.cv.delta[[1]]
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.007,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.01)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="boot",parallel=FALSE,solver=FALSE,step=0.01)
fit.cv.delta[[1]]
setwd("C:/Users/RJacobucci/Documents/GitHub/mimic_regsem")
setwd("C:/Users/Ross/Documents/GitHub/mimic_regsem")
library(lavaan)
library(qgraph)
library(semPlot)
library(psych)
library(regsem)
library(lmtest)
library(ggplot2)
library(reshape2)
library(semTools)
#Here one reads in the data - As I can't share it yet I created a dummy dataset with same means and covs.
#Parameter estimates are identical down to the third decimal so for now we can just use the dummy data (for final paper just rerun with the 'real' - only difference would be skewness and nonlinearities but those are negligible)
#datacamcan<-read.csv('CamCAN_cogneuro_data_Ross2017-03-16.csv')  #Reads in real data
datacamcan<-read.csv('schmamcandat2017-03-16.csv')
colnames(datacamcan)[3:50]<-print(paste('gm',1:48,sep=''))        #Unify grey matter labels for easier syntax
colnames(datacamcan)[51:98]<-print(paste('fa',1:48,sep=''))       #Unify grey matter labels for easier syntax
datacamcan$simpred1<-datacamcan$VSTMcolour_K_ss3+rnorm(708,.5,.5) #add dummy predictors for reference
datacamcan$simpred2<-datacamcan$VSTMcolour_K_ss3+rnorm(708,.5,.5) #add dummy predictors for reference
#Below the syntax to fit normal ML and regsem MIMIC models to predict a single LV (vstmlv) measured by three observables
#Syntax below is to use white matter (fa) and grey matter (gm) to predict a single LV.
#Total R^2 for FA predicting vstmlv is ~38% (versus 8% with noise), and ~27% for gm
#Most exciting would be to include both of course
#############Predicting VSTM: White matter (48 ROIS)
vstmCFA_WM<-'
vstmlv=~VSTMcolour_K_ss2+VSTMcolour_K_ss3+VSTMcolour_K_ss4
vstmlv~fa 1 +fa 2 +fa 3 +fa 4 +fa 5 +fa 6 +fa 7 +fa 8 +fa 9 +fa 10 +fa 11 +fa 12 +fa 13 +fa 14 +fa 15 +fa 16 +fa 17 +fa 18 +fa 19 +fa 20 +fa 21 +fa 22 +fa 23 +fa 24 +fa 25 +fa 26 +fa 27 +fa 28 +fa 29 +fa 30 +fa 31 +fa 32 +fa 33 +fa 34 +fa 35 +fa 36 +fa 37 +fa 38 +fa 39 +fa 40 +fa 41 +fa 42 +fa 43 +fa 44 +fa 45 +fa 46 +fa 47 +fa 48
'
fitvstm_WM <- cfa(vstmCFA_WM, data=datacamcan, estimator='mlr',missing='fiml')
summary(fitvstm_WM, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)
#regsem
lav.out_WM<-try(lavaan::sem(vstmCFA_WM,datacamcan,fixed.x=TRUE,meanstructure=FALSE),silent=TRUE)
A <- extractMatrices(lav.out_WM)$A
A[A!=0]
#cov.test= cov(data.test[,c(51:98,100:102)],use="complete.obs")
#tt = regsem(lav.out_WM)
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=20,jump=0.002,solver=FALSE,tol=1e-6,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="boot",mult.start=TRUE)
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=20,jump=0.002,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="boot",mult.start=TRUE)
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.002,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE)
reg.out2_WM
library(regsem)
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.002,solver=TRUE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE)
?nlminb
library(regsem)
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.002,solver=TRUE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE)
reg.out2_WM
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.002,solver=TRUE,tol=1e-6,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.5)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="boot",parallel=FALSE,solver=TRUE,step=0.5)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.5)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[1]]
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[1]]
?nlminb
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.5)
fit.cv.delta[[1]]
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.5)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.5)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[1]]
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[1]]
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=1,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=2,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=10,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.01)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.0001)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.005,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[1]]
library(regsem)
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.002,solver=TRUE,tol=1e-6,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.5)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.005,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.001)
plot(fit.cv.delta[[1]])
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.012,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
plot(fit.cv.delta[[1]])
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.012,multi.iter=20,mult.start=TRUE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.012,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
plot(fit.cv.delta[[1]])
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.012,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.012,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.5)
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.00012,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.5)
plot(fit.cv.delta[[1]])
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.00012,multi.iter=20,mult.start=FALSE,gradFun="numDeriv",
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.5)
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.012,multi.iter=20,mult.start=FALSE,gradFun="numDeriv",
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=0.001)
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.012,multi.iter=20,mult.start=FALSE,gradFun="numDeriv",
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=0.001)
plot(fit.cv.delta[[1]])
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.002,solver=FALSE,gradFun="numDeriv",tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.001)
reg.out2_WM
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.02,solver=FALSE,gradFun="numDeriv",tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.001)
reg.out2_WM
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.02,solver=FALSE,gradFun="ram",tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.001)
reg.out2_WM
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.2,solver=FALSE,gradFun="ram",tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.001)
reg.out2_WM
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.2,solver=FALSE,gradFun="ram",tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.01)
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=2,solver=FALSE,gradFun="ram",tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.001)
reg.out2_WM
library(regsem)
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=2,solver=TRUE,tol=1e-8,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.001)
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=2,solver=TRUE,tol=1e-6,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.001)
library(regsem)
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.001,solver=TRUE,tol=1e-6,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=1)
reg.out2_WM
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.012,multi.iter=20,mult.start=FALSE,gradFun="numDeriv",
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=1)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.003,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.003,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=1)
fit.cv.delta[[1]]
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.003,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.005,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.0001,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.0001,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.0001,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=FALSE,
n.lambda=50,tol=1e-6,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=.1)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[1]]
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.0001,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.001,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=.01)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=.01)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.0001,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.0001,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.0001,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.0001,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=TRUE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.01,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="numDeriv")
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="numDeriv")
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="ram")
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="norm")
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="numDeriv")
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.001,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.1,hessFun="numDeriv")
plot(reg.out2_WM,c(3:50))
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.1,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.1,hessFun="numDeriv")
plot(reg.out2_WM,c(3:50))
reg.out2_WM
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.1,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=1,hessFun="numDeriv")
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.1,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=1,hessFun="ram")
library(regsem)
v
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.1,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=1,hessFun="numDeriv")
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="ram")
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.1,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=1,hessFun="ram")
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=.1,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=1,hessFun="numDeriv")
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=.1,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.1,hessFun="numDeriv")
plot(reg.out2_WM,c(3:50))
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=1,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.1,hessFun="numDeriv")
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=.8,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=TRUE,step=.1,hessFun="numDeriv")
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="ram")
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="numDeriv")
library(regsem)
library(regsem)
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="ram")
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="norm")
library(regsem)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1)
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="ram")
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="numDeriv")
plot(fit.cv.delta[[1]])
fit.cv.delta[[i]] = cv_regsem(fit.delta[[i]],type="lasso",pars_pen = c(2:11),jump=0.1,multi.iter=20,mult.start=FALSE,
n.lambda=10,tol=1e-4,fit.ret="chisq",fit.ret2="train",parallel=FALSE,solver=FALSE,step=.1,hessFun="norm")
fit.cv.delta[[1]]
plot(fit.cv.delta[[1]])
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=.8,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=FALSE,step=.1,hessFun="norm")
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.8,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=FALSE,step=.1,hessFun="norm")
plot(reg.out2_WM,c(3:50))
reg.out2_WM
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.1,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp"),fit.ret2="train",mult.start=FALSE,step=1,hessFun="norm")
library(regsem)
library(regsem)
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=.1,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp","bic","rmsea"),fit.ret2="train",mult.start=FALSE,step=1,hessFun="norm")
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=12,jump=.8,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp","bic","rmsea"),fit.ret2="train",mult.start=FALSE,step=.1,hessFun="norm")
reg.out2_WM
plot(reg.out2_WM,c(3:50))
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=22,jump=.8,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp","bic","rmsea"),fit.ret2="train",mult.start=FALSE,step=.1,hessFun="norm")
plot(reg.out2_WM,c(3:50))
reg.out2_WM
plot(reg.out2_WM,c(3:50))
reg.out2_WM <- cv_regsem(lav.out_WM,n.lambda=22,jump=.8,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50),
fit.ret=c("chisq","ncp","BIC","rmsea"),fit.ret2="train",mult.start=FALSE,step=.1,hessFun="numDeriv")
plot(reg.out2_WM,c(3:50))
reg.out2_WM
