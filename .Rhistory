# increase to > 25
cv.out = cv_regsem(outt,type="scad", pars_pen=c(1:3,7:9),optMethod="NlcOptim",
n.lambda=15,jump=0.05)
# increase to > 25
cv.out = cv_regsem(outt,type="mcp", pars_pen=c(1:3,7:9),optMethod="NlcOptim",
n.lambda=15,jump=0.05)
# increase to > 25
cv.out = cv_regsem(outt,type="mcp", pars_pen=c(1:3,7:9),optMethod="NlcOptim",
n.lambda=15,jump=0.01)
# increase to > 25
cv.out = cv_regsem(outt,type="scad", pars_pen=c(1:3,7:9),optMethod="NlcOptim",
n.lambda=15,jump=0.01)
plot(cv.out)
# increase to > 25
cv.out = cv_regsem(outt,type="lasso", pars_pen=c(1:3,7:9),optMethod="NlcOptim",
n.lambda=15,jump=0.01)
library(regsem)
library(regsem)
# increase to > 25
cv.out = cv_regsem(outt,type="alasso", pars_pen=c(1:3,7:9),optMethod="NlcOptim",
n.lambda=15,jump=0.01)
plot(cv.out)
# increase to > 25
cv.out = cv_regsem(outt,type="alasso", pars_pen=c(1:3,7:9),optMethod="rsolnp",
n.lambda=15,jump=0.01)
plot(cv.out)
# increase to > 25
cv.out = cv_regsem(outt,type="alasso", pars_pen=c(1:3,7:9),optMethod="NlcOptim",
n.lambda=15,jump=0.01)
plot(cv.out)
# increase to > 25
cv.out = cv_regsem(outt,type="alasso", pars_pen=c(1:3,7:9),optMethod="NlcOptim",
n.lambda=15,jump=0.02)
plot(cv.out)
# increase to > 25
cv.out = cv_regsem(outt,type="alasso", pars_pen=c(1:3,7:9),optMethod="NlcOptim",
n.lambda=20,jump=0.02)
plot(cv.out)
# increase to > 25
cv.out = cv_regsem(outt,type="alasso", pars_pen=c(1:3,7:9),optMethod="NlcOptim",
n.lambda=20,jump=0.02)
# increase to > 25
cv.out = cv_regsem(outt,type="alasso", pars_pen=c(1:3,7:9),optMethod="rsolnp",
n.lambda=20,jump=0.02)
plot(cv.out)
library(regsem)
mod <- '
f =~ NA*x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9
x1~~x2;x1~~x3;x2~~x3
f~~1*f
'
outt = cfa(mod, HS)
summary(outt)
extractMatrices(outt)
# increase to > 25
cv.out = cv_regsem(outt,type="alasso", pars_pen=c(1:3,7:9,10:12),optMethod="rsolnp",
n.lambda=20,jump=0.02)
plot(cv.out)
cv.out
# increase to > 25
cv.out = cv_regsem(outt,type="lasso", pars_pen=c(1:3,7:9,10:12),optMethod="rsolnp",
n.lambda=20,jump=0.02)
cv.out
plot(cv.out)
# increase to > 25
cv.out = cv_regsem(outt,type="lasso", pars_pen=c(10:12),optMethod="rsolnp",
n.lambda=20,jump=0.02)
cv.out
plot(cv.out)
# increase to > 25
cv.out = cv_regsem(outt,type="lasso", pars_pen=c(10:12),optMethod="rsolnp",
n.lambda=20,jump=0.05)
cv.out
plot(cv.out)
# increase to > 25
cv.out = cv_regsem(outt,type="lasso", pars_pen=c(10:12),optMethod="coord_desc",
n.lambda=20,jump=0.05)
cv.out
plot(cv.out)
mod <- '
f =~ NA*x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9
x1~~x2;x1~~x3;x2~~x3;x1~~x4;x2~~x4;x3~~x4;
x1~~x5;x2~~x5;x3~~x5;x4~~x5;x1~~x6;x2~~x6;x3~~x6;
x4~~x6;x5~~x5;
f~~1*f
'
outt = cfa(mod, HS)
summary(outt)
extractMatrices(outt)
# increase to > 25
cv.out = cv_regsem(outt,type="lasso", pars_pen=c(10:23),optMethod="coord_desc",
n.lambda=20,jump=0.05)
# increase to > 25
cv.out = cv_regsem(outt,type="lasso", pars_pen=c(10:23),optMethod="rsolnp",
n.lambda=20,jump=0.05)
cv.out
mod1 <- '
f =~ NA*x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9
f~~1*f
'
out = cfa(mod1, HS)
summary(out)
plot(cv.out)
sim.mod <-"
f1 =~ x1 + x2 + x3
f2 =~ x4 + x5 + x6
f3 =~ x7 + x8 + x9
"
dat <- simulateData(sim.mod,model.type="cfa")
head(dat)
sim.run <- cfa(mod1,dat)
summary(sim.run)
mod2 <- '
f =~ NA*x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9
x1~~x2;x1~~x3;x2~~x3;x1~~x4;x2~~x4;x3~~x4;
x1~~x5;x2~~x5;x3~~x5;x4~~x5;x1~~x6;x2~~x6;x3~~x6;
x4~~x6;x5~~x6;x1~~x7;x2~~x7;x3~~x7;x4~~x7;x5~~x7;
x6~~x7;x1~~x8;x2~~x8;x3~~x8;x4~~x8;x5~~x8;x6~~x8;
x7~~x8;x1~~x9;x2~~x9;x3~~x9;x4~~x9;x5~~x9;x6~~x9;
x7~~x9;x8~~x9;
f~~1*f
'
sim.run2 <- cfa(mod2,dat)
summary(sim.run2)
extractMatrices(sim.run2)
cv.out2 = cv_regsem(sim.run2,type="lasso", pars_pen=c(10:45),optMethod="rsolnp",
n.lambda=20,jump=0.05)
plot(cv.out2)
cv.out2
summary(sim.run2,fit=T)
sim.mod2 <-"
f =~ x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9
f1 =~ x1 + x2 + x3
f2 =~ x4 + x5 + x6
f3 =~ x7 + x8 + x9
"
dat2 <- simulateData(sim.mod2,model.type="cfa",orthogonal=T)
sim.run2 <- cfa(mod1,dat2)
summary(sim.run2)
sim.run3 <- cfa(mod1,dat2)
summary(sim.run3)
sim.run4 <- cfa(mod2,dat2)
summary(sim.run4,fit=T)
extractMatrices(sim.run4)
cv.out3 = cv_regsem(sim.run4,type="lasso", pars_pen=c(10:45),optMethod="rsolnp",
n.lambda=20,jump=0.05)
plot(cv.out3)
cv.out3
sim.mod <-"
f1 =~ x1 + x2 + x3
f2 =~ x4 + x5 + x6
f3 =~ x7 + x8 + x9
"
dat <- simulateData(sim.mod,model.type="cfa")
sim.run <- cfa(mod1,dat)
summary(sim.run)
mod2 <- '
f =~ NA*x1 + x2 + x3 + x4 + x5 + x6 + x7 + x8 + x9
x1~~x2;x1~~x3;x2~~x3;x1~~x4;x2~~x4;x3~~x4;
x1~~x5;x2~~x5;x3~~x5;x4~~x5;x1~~x6;x2~~x6;x3~~x6;
x4~~x6;x5~~x6;x1~~x7;x2~~x7;x3~~x7;x4~~x7;x5~~x7;
x6~~x7;x1~~x8;x2~~x8;x3~~x8;x4~~x8;x5~~x8;x6~~x8;
x7~~x8;x1~~x9;x2~~x9;x3~~x9;x4~~x9;x5~~x9;x6~~x9;
x7~~x9;x8~~x9;
f~~1*f
'
sim.run2 <- cfa(mod2,dat)
summary(sim.run2,fit=T)
cv.out2 = cv_regsem(sim.run2,type="lasso", pars_pen=c(10:45),optMethod="rsolnp",
n.lambda=20,jump=0.05)
plot(cv.out2)
cv.out2
plot(cv.out3)
cv.out3$final_pars
library(regsem)
model <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~1*t1;t2~~1*t2;t3~~0.5*t3;t4~~0.5*t4'
dat <- simulateData(model,model.type="sem")
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
summary(fit)
model <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
s~1*1;i~1*1;s~~1*i;
t1~~1*t1;t2~~1*t2;t3~~0.5*t3;t4~~0.5*t4'
dat <- simulateData(model,model.type="sem")
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
summary(fit)
mod2 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~r1*t1;t2~~r1*t2;t3~~r1*t3;t4~~r1*t4;
'
fit2 <- growth(mod2, data=dat)
summary(fit2)
model <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
s~1*1;i~1*1;s~~.5*i;
t1~~1*t1;t2~~1*t2;t3~~0.5*t3;t4~~0.5*t4'
dat <- simulateData(model,model.type="sem")
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
summary(fit)
mod2 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~r1*t1;t2~~r1*t2;t3~~r1*t3;t4~~r1*t4;
'
fit2 <- growth(mod2, data=dat)
summary(fit2)
dat <- simulateData(model,model.type="sem",sample.nobs = 2000)
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
summary(fit)
mod2 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~r1*t1;t2~~r1*t2;t3~~r1*t3;t4~~r1*t4;
'
fit2 <- growth(mod2, data=dat)
summary(fit2)
dat <- simulateData(model,model.type="sem",sample.nobs = 20000)
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
summary(fit)
mod2 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~r1*t1;t2~~r1*t2;t3~~r1*t3;t4~~r1*t4;
'
fit2 <- growth(mod2, data=dat)
summary(fit2)
?cv_regsem
summary(fit)
summary(fit)
summary(fit2)
extractMatrices(fit)
cv.out <- cv_regsem(fit,n.lambda=15,jump=0.01,type="diff_lasso",diff_par=0.75,pars_pen=3:6)
cv.out
plot(cv.out)
cv.out <- cv_regsem(fit,n.lambda=30,jump=0.01,type="diff_lasso",diff_par=0.75,pars_pen=3:6)
cv.out
plot(cv.out)
dat <- simulateData(model,model.type="sem",sample.nobs = 200)
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
summary(fit)
mod2 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~r1*t1;t2~~r1*t2;t3~~r1*t3;t4~~r1*t4;
'
fit2 <- growth(mod2, data=dat)
summary(fit2)
extractMatrices(fit)
cv.out <- cv_regsem(fit,n.lambda=30,jump=0.01,type="diff_lasso",diff_par=0.75,pars_pen=3:6)
cv.out
plot(cv.out)
coef(fit2)
cv.out <- cv_regsem(fit,n.lambda=30,jump=0.01,type="diff_lasso",diff_par=coef(fit2)[1],pars_pen=3:6)
cv.out
plot(cv.out)
cv.out <- cv_regsem(fit,n.lambda=40,jump=0.01,type="diff_lasso",diff_par=coef(fit2)[1],pars_pen=3:6)
cv.out
plot(cv.out)
coef(fit2)
coef(fit)
coef(fit)[1:4]
cv.out$final_pars
cv.out$final_pars[3:7]
?simulateData
?cv_regsem
library(regsem)
cv.out <- cv_regsem(fit,n.lambda=40,jump=0.01,type="diff_lasso",diff_par=coef(fit2)[1],pars_pen=3:6,verbose=F)
library(regsem)
ret.matrix <- matrix(NA,100,4)
ret.matrix2 <- matrix(NA,100,4)
for(i in 1:100){
model <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
s~1*1;i~1*1;s~~.5*i;
t1~~1*t1;t2~~1*t2;t3~~0.5*t3;t4~~0.5*t4'
dat <- simulateData(model,model.type="sem",sample.nobs = 200,seed=i)
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
#summary(fit)
ret.matrix[i,] <- coef(fit)[1:4]
mod2 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~r1*t1;t2~~r1*t2;t3~~r1*t3;t4~~r1*t4;
'
fit2 <- growth(mod2, data=dat)
#summary(fit2)
#coef(fit2)[1]
#extractMatrices(fit)
cv.out <- cv_regsem(fit,n.lambda=40,jump=0.01,type="diff_lasso",diff_par=coef(fit2)[1],pars_pen=3:6,verbose=F)
ret.matrix2[i,] <- cv.out$final_pars[3:6]
print(i)
}
summary(ret.matrix)
summary(ret.matrix2)
bias(ret.matrix,c(1,1,.5,.5))
library(SimDesign)
bias(ret.matrix,c(1,1,.5,.5))
bias(ret.matrix,c(1,1,.5,.5),relative=TRUE)
bias(ret.matrix2,c(1,1,.5,.5),relative=TRUE)
RMSE(ret.matrix,c(1,1,.5,.5))
RMSE(ret.matrix2,c(1,1,.5,.5))
library(regsem)
ret.matrix <- matrix(NA,100,4)
ret.matrix2 <- matrix(NA,100,4)
for(i in 1:100){
model <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
s~1*1;i~1*1;s~~.5*i;
t1~~1*t1;t2~~1*t2;t3~~1*t3;t4~~1*t4'
dat <- simulateData(model,model.type="sem",sample.nobs = 200,seed=i)
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
#summary(fit)
ret.matrix[i,] <- coef(fit)[1:4]
mod2 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~r1*t1;t2~~r1*t2;t3~~r1*t3;t4~~r1*t4;
'
fit2 <- growth(mod2, data=dat)
#summary(fit2)
#coef(fit2)[1]
#extractMatrices(fit)
cv.out <- cv_regsem(fit,n.lambda=40,jump=0.01,type="diff_lasso",diff_par=coef(fit2)[1],pars_pen=3:6,verbose=F)
ret.matrix2[i,] <- cv.out$final_pars[3:6]
print(i)
}
bias(ret.matrix,c(1,1,1,1),relative=TRUE)
bias(ret.matrix2,c(1,1,1,1),relative=TRUE)
RMSE(ret.matrix,c(1,1,1,1))
RMSE(ret.matrix2,c(1,1,1,1))
library(regsem)
ret.matrix <- matrix(NA,100,9)
ret.matrix2 <- matrix(NA,100,9)
for(i in 1:100){
model <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
s~1*1;i~1*1;s~~.5*i;
t1~~1*t1;t2~~1*t2;t3~~1*t3;t4~~1*t4'
dat <- simulateData(model,model.type="sem",sample.nobs = 200,seed=i)
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
#summary(fit)
ret.matrix[i,] <- coef(fit)
mod2 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~r1*t1;t2~~r1*t2;t3~~r1*t3;t4~~r1*t4;
'
fit2 <- growth(mod2, data=dat)
#summary(fit2)
#coef(fit2)[1]
#extractMatrices(fit)
cv.out <- cv_regsem(fit,n.lambda=40,jump=0.01,type="diff_lasso",diff_par=coef(fit2)[1],pars_pen=3:6,verbose=F)
ret.matrix2[i,] <- cv.out$final_pars
print(i)
}
cv.out$final_pars
cv.out
library(regsem)
cv.out <- cv_regsem(fit,n.lambda=40,jump=0.01,type="diff_lasso",diff_par=coef(fit2)[1],pars_pen=3:6,verbose=F)
cv.out$final_pars
library(regsem)
ret.matrix <- matrix(NA,100,9)
ret.matrix2 <- matrix(NA,100,9)
for(i in 1:100){
model <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
s~1*1;i~1*1;s~~.5*i;
t1~~1*t1;t2~~1*t2;t3~~1*t3;t4~~1*t4'
dat <- simulateData(model,model.type="sem",sample.nobs = 200,seed=i)
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
#summary(fit)
ret.matrix[i,] <- coef(fit)
mod2 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~r1*t1;t2~~r1*t2;t3~~r1*t3;t4~~r1*t4;
'
fit2 <- growth(mod2, data=dat)
#summary(fit2)
#coef(fit2)[1]
#extractMatrices(fit)
cv.out <- cv_regsem(fit,n.lambda=40,jump=0.01,type="diff_lasso",diff_par=coef(fit2)[1],pars_pen=3:6,verbose=F)
ret.matrix2[i,] <- cv.out$final_pars
print(i)
}
library(SimDesign)
coef(fit)
bias(ret.matrix,c(1,1,1,1,1,1,.5,1,1),relative=TRUE)
bias(ret.matrix2,c(1,1,1,1,1,1,.5,1,1),relative=TRUE)
RMSE(ret.matrix,c(1,1,1,1,1,1,.5,1,1))
RMSE(ret.matrix2,c(1,1,1,1,1,1,.5,1,1))
cv.out$final_pars
bias(ret.matrix,c(1,1,1,1,1,1,.5,1,1),relative=TRUE)
bias(ret.matrix2,c(1,1,1,1,1,1,1,1,.5),relative=TRUE)
summary(fit2)
RMSE(ret.matrix,c(1,1,1,1,1,1,.5,1,1))
RMSE(ret.matrix2,c(1,1,1,1,1,1,1,1,.5))
RMSE(ret.matrix,c(1,1,1,1,1,1,.5,1,1))
RMSE(ret.matrix2,c(1,1,1,1,1,1,1,1,.5))
RMSE(ret.matrix2,c(1,1,1,1,1,1,1,1,.5))[c(1:6,9,7,8)]
RMSE(ret.matrix,c(1,1,1,1,1,1,.5,1,1))
cv.out$final_pars
coef(fit)
cv.out$final_pars
bias(ret.matrix,c(1,1,1,1,1,1,.5,1,1),relative=TRUE)
bias(ret.matrix2,c(1,1,1,1,1,1,1,1,.5),relative=TRUE)[c(3:9,1,2)]
round(bias(ret.matrix,c(1,1,1,1,1,1,.5,1,1),relative=TRUE),3)
round(bias(ret.matrix2,c(1,1,1,1,1,1,1,1,.5),relative=TRUE)[c(3:9,1,2)],3)
round(RMSE(ret.matrix,c(1,1,1,1,1,1,.5,1,1)),3)
round(RMSE(ret.matrix2,c(1,1,1,1,1,1,1,1,.5))[c(3:9,1,2)],3)
library(regsem)
ret.matrix <- matrix(NA,100,9)
ret.matrix2 <- matrix(NA,100,9)
for(i in 1:100){
model <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
s~1*1;i~1*1;s~~.5*i;
t1~~1*t1;t2~~1*t2;t3~~0.5*t3;t4~~0.5*t4'
dat <- simulateData(model,model.type="sem",sample.nobs = 80,seed=i)
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
#summary(fit)
ret.matrix[i,] <- coef(fit)
mod2 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~r1*t1;t2~~r1*t2;t3~~r1*t3;t4~~r1*t4;
'
fit2 <- growth(mod2, data=dat)
#summary(fit2)
#coef(fit2)[1]
#extractMatrices(fit)
cv.out <- cv_regsem(fit,n.lambda=40,jump=0.01,type="diff_lasso",diff_par=coef(fit2)[1],pars_pen=3:6,verbose=F)
ret.matrix2[i,] <- cv.out$final_pars
print(i)
}
bias(ret.matrix,c(1,1,.5,.5),relative=TRUE)
round(bias(ret.matrix,c(1,1,1,1,1,1,.5,1,1),relative=TRUE),3)
round(bias(ret.matrix2,c(1,1,1,1,1,1,1,1,.5),relative=TRUE)[c(3:9,1,2)],3)
summary(ret.matrix)
round(bias(ret.matrix,c(1,1,1,1,1,1,.5,1,1),relative=TRUE),3)
round(bias(ret.matrix2,c(1,1,1,1,1,1,1,1,.5),relative=TRUE)[c(3:9,1,2)],3)
round(RMSE(ret.matrix,c(1,1,1,1,1,1,.5,1,1)),3)
round(RMSE(ret.matrix2,c(1,1,1,1,1,1,1,1,.5))[c(3:9,1,2)],3)
cv.out <- cv_regsem(fit,n.lambda=40,jump=0.01,type="diff_lasso",
fit.ret=c("BIC","ncp","rmsea"),metric="ncp",
fit.ret2="boot",
diff_par=coef(fit2)[1],pars_pen=3:6,verbose=F)
cv.out <- cv_regsem(fit,n.lambda=20,jump=0.02,type="diff_lasso",
fit.ret=c("BIC","ncp","rmsea"),metric="ncp",
fit.ret2="boot",
diff_par=coef(fit2)[1],pars_pen=3:6,verbose=F)
cv.out$final_pars
cv.out
library(regsem)
ret.matrix <- matrix(NA,100,9)
ret.matrix2 <- matrix(NA,100,9)
for(i in 1:100){
model <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
s~1*1;i~1*1;s~~.5*i;
t1~~1*t1;t2~~1*t2;t3~~0.5*t3;t4~~0.5*t4'
dat <- simulateData(model,model.type="sem",sample.nobs = 80,seed=i)
mod1 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
'
fit <- growth(mod1, data=dat)
#summary(fit)
ret.matrix[i,] <- coef(fit)
mod2 <- ' i =~ 1*t1 + 1*t2 + 1*t3 + 1*t4
s =~ 0*t1 + 1*t2 + 2*t3 + 3*t4
t1~~r1*t1;t2~~r1*t2;t3~~r1*t3;t4~~r1*t4;
'
fit2 <- growth(mod2, data=dat)
#summary(fit2)
#coef(fit2)[1]
#extractMatrices(fit)
cv.out <- cv_regsem(fit,n.lambda=20,jump=0.02,type="diff_lasso",
fit.ret=c("BIC","ncp","rmsea"),metric="ncp",
fit.ret2="boot",
diff_par=coef(fit2)[1],pars_pen=3:6,verbose=F)
ret.matrix2[i,] <- cv.out$final_pars
print(i)
}
warnings()
library(regsem)
library(regsem)
