vstmCFA_WM<-'
vstmlv=~VSTMcolour_K_ss2+VSTMcolour_K_ss3+VSTMcolour_K_ss4
vstmlv~fa 1 +fa 2 +fa 3 +fa 4 +fa 5 +fa 6 +fa 7 +fa 8 +fa 9 +fa 10 +fa 11 +fa 12 +fa 13 +fa 14 +fa 15 +fa 16 +fa 17 +fa 18 +fa 19 +fa 20 +fa 21 +fa 22 +fa 23 +fa 24 +fa 25 +fa 26 +fa 27 +fa 28 +fa 29 +fa 30 +fa 31 +fa 32 +fa 33 +fa 34 +fa 35 +fa 36 +fa 37 +fa 38 +fa 39 +fa 40 +fa 41 +fa 42 +fa 43 +fa 44 +fa 45 +fa 46 +fa 47 +fa 48
vstmlv~1
'
lav.out_WM<-try(lavaan::sem(vstmCFA_WM,datacamcan,fixed.x=TRUE,meanstructure=FALSE),silent=TRUE)
summary(lav.out_WM)
vstmCFA_WM<-'
vstmlv=~VSTMcolour_K_ss2+VSTMcolour_K_ss3+VSTMcolour_K_ss4
vstmlv~fa 1 +fa 2 +fa 3 +fa 4 +fa 5 +fa 6 +fa 7 +fa 8 +fa 9 +fa 10 +fa 11 +fa 12 +fa 13 +fa 14 +fa 15 +fa 16 +fa 17 +fa 18 +fa 19 +fa 20 +fa 21 +fa 22 +fa 23 +fa 24 +fa 25 +fa 26 +fa 27 +fa 28 +fa 29 +fa 30 +fa 31 +fa 32 +fa 33 +fa 34 +fa 35 +fa 36 +fa 37 +fa 38 +fa 39 +fa 40 +fa 41 +fa 42 +fa 43 +fa 44 +fa 45 +fa 46 +fa 47 +fa 48
'
lav.out_WM<-try(lavaan::sem(vstmCFA_WM,datacamcan,fixed.x=TRUE,meanstructure=TRUE),silent=TRUE)
summary(lav.out_WM)
A <- extractMatrices(lav.out_WM)$A
A[A!=0]
A
reg.out <- multi_optim(lav.out_WM,max.try=1,type="lasso",lambda=0,#pars_pen=c(40:50),
step.ratio=FALSE,step=.01,full=TRUE,max.iter=150);summary(reg.out)
?multi_optim
reg.out <- multi_optim(lav.out_WM,max.try=1,type="lasso",lambda=0,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=.1,full=TRUE,max.iter=150);summary(reg.out)
reg.out <- multi_optim(lav.out_WM,max.try=1,type="lasso",lambda=0,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=1,full=TRUE,max.iter=150);summary(reg.out)
reg.out <- multi_optim(lav.out_WM,max.try=1,type="lasso",lambda=0,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=.5,full=TRUE,max.iter=150);summary(reg.out)
library(regsem)
reg.out <- multi_optim(lav.out_WM,max.try=1,type="lasso",lambda=0,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=.5,full=TRUE,max.iter=10);summary(reg.out)
reg.out <- multi_optim(lav.out_WM,max.try=1,type="none",lambda=0,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=.5,full=TRUE,max.iter=10);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="none",lambda=0,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=.5,full=TRUE,max.iter=10);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=.5,full=TRUE,max.iter=10);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="enet",lambda=0,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=.5,full=TRUE,max.iter=10);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="scad",lambda=0,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=.5,full=TRUE,max.iter=10);summary(reg.out)
library(regsem)
?regsem
reg.out <- regsem(lav.out_WM,type="scad",lambda=0,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=.5,full=TRUE,max.iter=10);summary(reg.out)
library(regsem)
reg.out <- regsem(lav.out_WM,type="scad",lambda=0,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=.5,full=TRUE,max.iter=10);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="scad",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=FALSE,step=.5,full=TRUE,max.iter=10);summary(reg.out)
lav.out_WM<-try(lavaan::sem(vstmCFA_WM,datacamcan,fixed.x=FALSE,meanstructure=TRUE),silent=TRUE)
lav.out_WM<-try(lavaan::sem(vstmCFA_WM,datacamcan,fixed.x=TRUE,meanstructure=TRUE),silent=TRUE)
reg.out <- regsem(lav.out_WM,type="scad",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=FALSE,step=.01,full=TRUE,max.iter=2);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=FALSE,step=.01,full=TRUE,max.iter=2);summary(reg.out)
library(regsem)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=FALSE,step=.01,full=FALSE,max.iter=2);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=TRUE,step=.01,full=FALSE,max.iter=2);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=TRUE,step=1,full=FALSE,max.iter=2);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=TRUE,step=.5,full=FALSE,max.iter=5);summary(reg.out)
library(regsem)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=TRUE,step=.5,full=FALSE,max.iter=5);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=TRUE,step=.5,full=FALSE,max.iter=30);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=TRUE,step=.1,full=FALSE,max.iter=30);summary(reg.out)
library(regsem)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=TRUE,step=.1,full=FALSE,max.iter=30);summary(reg.out)
extractMatrices(lav.out_WM)
library(regsem)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=TRUE,step=.1,full=FALSE,max.iter=30);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="none",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=TRUE,step=.1,full=FALSE,max.iter=30);summary(reg.out)
lav.out_WM<-try(lavaan::sem(vstmCFA_WM,datacamcan,fixed.x=TRUE,meanstructure=FALSE),silent=TRUE)
summary(lav.out_WM)
reg.out <- regsem(lav.out_WM,type="none",lambda=0,optMethod="coord_desc",gradFun="numDeriv",#pars_pen=c(40:50),
step.ratio=TRUE,step=.1,full=FALSE,max.iter=30);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.01,optMethod="coord_desc",gradFun="ram",#pars_pen=c(40:50),
step.ratio=FALSE,step=.1,full=TRUE,max.iter=30);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=FALSE,step=.1,full=TRUE,max.iter=30);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.1,full=FALSE,max.iter=30);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=FALSE,step=.1,full=FALSE,max.iter=30);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=1,full=FALSE,max.iter=30);summary(reg.out)
library(regsem)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=1,full=FALSE,max.iter=30);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.1,full=FALSE,max.iter=30);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.1,full=TRUE,max.iter=30);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.5,full=TRUE,max.iter=30);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.5,full=TRUE,max.iter=50);summary(reg.out)
reg.out <- multi_optim(lav.out_WM,type="lasso",max.try=10,lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.5,full=TRUE,max.iter=50);summary(reg.out)
reg.out <- multi_optim(lav.out_WM,type="lasso",max.try=10,lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.5,full=TRUE,max.iter=50,alpha.inc=TRUE);summary(reg.out)
reg.out <- multi_optim(lav.out_WM,type="lasso",max.try=10,lambda=0.0001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.5,full=TRUE,max.iter=50,alpha.inc=TRUE);summary(reg.out)
reg.out <- multi_optim(lav.out_WM,type="lasso",max.try=10,lambda=0.0001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.1,full=TRUE,max.iter=50,alpha.inc=FALSE);summary(reg.out)
reg.out <- multi_optim(lav.out_WM,type="lasso",max.try=10,lambda=0.0001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.1,full=TRUE,max.iter=50,momentum=TRUE);summary(reg.out)
reg.out <- multi_optim(lav.out_WM,type="lasso",max.try=10,lambda=0.0001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=FALSE,step=.1,full=TRUE,max.iter=50,momentum=TRUE);summary(reg.out)
reg.out <- multi_optim(lav.out_WM,type="lasso",max.try=10,lambda=0.0001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=FALSE,step=.01,full=TRUE,max.iter=50,momentum=TRUE);summary(reg.out)
reg.out <- multi_optim(lav.out_WM,type="lasso",max.try=10,lambda=0.0001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=FALSE,step=.01,full=TRUE,max.iter=50,tol=1e-3,momentum=TRUE);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.0001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=FALSE,step=.01,full=TRUE,max.iter=50,tol=1e-3,momentum=TRUE);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.0001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=FALSE,step=.01,full=TRUE,max.iter=50,tol=1e-3);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.0001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=FALSE,step=.01,full=TRUE,max.iter=100,tol=1e-4);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.0001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.01,full=FALSE,max.iter=100,tol=1e-4);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.0001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.01,full=TRUE,max.iter=100,tol=1e-4,solver=TRUE);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.01,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.01,full=TRUE,max.iter=100,tol=1e-4,solver=TRUE);summary(reg.out)
reg.out <- regsem(lav.out_WM,type="lasso",lambda=0.001,optMethod="coord_desc",gradFun="ram",pars_pen=c(3:50),
step.ratio=TRUE,step=.01,full=TRUE,max.iter=100,tol=1e-4,solver=TRUE);summary(reg.out)
A
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.001,mult.start=FALSE,max.iter=100,solver=TRUE,type="lasso",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=0.001,mult.start=FALSE,max.iter=100,solver=TRUE,type="lasso",pars_pen=c(3:50))
reg.out1_WM
fitmeasures(lav.out_WM)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=0.001,mult.start=TRUE,max.iter=200,solver=TRUE,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=0.001,mult.start=TRUE,max.iter=200,step=.01,solver=TRUE,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=0.001,mult.start=TRUE,max.iter=200,momentum=TRUE,solver=TRUE,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=0.001,mult.start=TRUE,max.iter=200,momentum=TRUE,solver=TRUE,tol=1e-4,,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=0.001,mult.start=TRUE,max.iter=200,alpha.inc=TRUE,solver=TRUE,tol=1e-4,,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=0.001,mult.start=TRUE,max.iter=200,alpha.inc=TRUE,solver=TRUE,tol=1e-3,,type="lasso",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM[,28]
reg.out1_WM[[1]][28,]
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=25,jump=0.002,mult.start=TRUE,max.iter=200,solver=TRUE,tol=1e-3,step=.01,type="lasso",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=0.002,mult.start=TRUE,max.iter=100,solver=TRUE,tol=1e-3,step=.01,type="lasso",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=0.002,mult.start=TRUE,max.iter=100,solver=TRUE,tol=1e-3,step=.01,type="enet",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=0.005,mult.start=TRUE,max.iter=100,solver=TRUE,tol=1e-3,step=.1,type="enet",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=0.002,mult.start=TRUE,max.iter=100,solver=TRUE,tol=1e-3,step=.01,type="enet",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=0.002,mult.start=TRUE,max.iter=100,solver=TRUE,tol=1e-3,step=.01,type="scad",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=0.002,mult.start=TRUE,max.iter=100,solver=TRUE,tol=1e-4,step=.01,type="lasso",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=20,jump=0.002,mult.start=TRUE,max.iter=100,solver=TRUE,tol=1e-4,step=.01,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=0.001,mult.start=TRUE,max.iter=100,solver=TRUE,tol=1e-4,step=.01,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=0.001,mult.start=TRUE,
max.iter=100,solver=TRUE,tol=1e-4,step=.01,type="lasso",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=0.001,mult.start=TRUE,
max.iter=100,solver=TRUE,tol=1e-4,step=.01,type="lasso",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=23,jump=0.001,mult.start=TRUE,
max.iter=100,solver=TRUE,tol=1e-4,step=.1,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=23,jump=0.001,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-4,step=.1,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=23,jump=0.001,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-4,step=.1,type="lasso",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=23,jump=0.001,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-4,step=.1,type="lasso",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=23,jump=0.001,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-4,step=.1,type="lasso",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=23,jump=0.001,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-4,step=.1,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=23,jump=0.001,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-4,step=.5,type="lasso",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=50,jump=0.0005,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-4,step=.5,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=10,jump=0.0005,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-4,step=.5,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.0005,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-4,step=.5,type="lasso",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.001,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-5,step=.1,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.001,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-5,step=.01,type="lasso",pars_pen=c(3:50))
?nlminb
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.001,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-5,step=.01,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.001,mult.start=TRUE,
max.iter=25,solver=TRUE,tol=1e-5,alpha.inc=TRUE,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.001,mult.start=FALSE,
max.iter=25,solver=TRUE,tol=1e-5,alpha.inc=TRUE,type="lasso",pars_pen=c(3:50))
reg.out1_WM
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.001,mult.start=FALSE,
max.iter=25,solver=TRUE,tol=1e-5,alpha.inc=TRUE,type="lasso",pars_pen=c(3:50))
warnings()
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.001,mult.start=FALSE,
max.iter=25,solver=TRUE,tol=1e-5,alpha.inc=TRUE,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.01,mult.start=FALSE,
max.iter=50,solver=TRUE,tol=1e-5,alpha.inc=TRUE,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.01,mult.start=FALSE,
max.iter=150,solver=TRUE,tol=1e-5,alpha.inc=TRUE,type="lasso",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.005,mult.start=FALSE,
max.iter=150,solver=TRUE,tol=1e-5,alpha.inc=TRUE,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.005,mult.start=FALSE,
max.iter=150,solver=TRUE,tol=1e-3,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.004,mult.start=FALSE,
max.iter=150,solver=TRUE,tol=1e-3,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.004,mult.start=FALSE,
max.iter=50,solver=TRUE,tol=1e-3,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.004,mult.start=FALSE,
max.iter=50,solver=TRUE,tol=1e-2,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.002,mult.start=FALSE,
max.iter=50,solver=TRUE,tol=1e-2,type="lasso",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM[[1]]
plot_cv(reg.out1_WM)
plot_cv(reg.out1_WM,c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.006,mult.start=FALSE,
max.iter=50,solver=TRUE,tol=1e-2,type="lasso",pars_pen=c(3:50))
plot_cv(reg.out1_WM,c(3:50))
reg.out1_WM
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.006,mult.start=FALSE,
max.iter=50,solver=TRUE,tol=1e-4,type="lasso",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=15,jump=0.006,mult.start=FALSE,
max.iter=50,solver=TRUE,tol=1e-4,type="lasso",pars_pen=c(3:50))
reg.out1_WM
plot_cv(reg.out1_WM,c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=0.006,mult.start=FALSE,
max.iter=50,solver=TRUE,tol=1e-4,type="lasso",pars_pen=c(3:50))
reg.out1_WM
plot_cv(reg.out1_WM,c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=0.006,mult.start=FALSE,
max.iter=150,solver=TRUE,tol=1e-4,type="lasso",pars_pen=c(3:50))
reg.out1_WM
plot_cv(reg.out1_WM,c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=0.002,mult.start=FALSE,
max.iter=150,solver=TRUE,tol=1e-4,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=30,jump=0.002,mult.start=FALSE,
max.iter=150,solver=TRUE,tol=1e-4,type="scad",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.002,mult.start=FALSE,
max.iter=150,solver=TRUE,tol=1e-4,type="scad",pars_pen=c(3:50))
reg.out1_WM
Xs <- seq(-2,2,.01)
plot(Xs,abs(Xs),"l",xlab="X",ylab="P(x)",ylim=c(0,1.2),lwd=2)
# see breheny
library(DiceKriging)
SCAD(.1,.1)
out <- rep(NA,length(Xs))
for(i in 1:length(Xs)){
out[i] <- SCAD(Xs[i],.5)
}
lines(Xs,out,"l",lty=2,lwd=2)
mcp <- function(x,lambda){
x <- abs(x)
a <- 3.7
if(x <= a*lambda){
lambda*x - (x**2)/(2*a)
}else{
.5*a*(lambda**2)
}
}
out2 <- rep(NA,length(Xs))
for(i in 1:length(Xs)){
out2[i] <- mcp(Xs[i],.5)
}
lines(Xs,out2,"l",lty=3,lwd=2)
abline(a=0,b=0)
legend("bottomright", c("Lasso","SCAD","MCP"),lty=c(1,2,3), lwd=2,cex=.8)
install.packages("DiceKriging")
Xs <- seq(-2,2,.01)
plot(Xs,abs(Xs),"l",xlab="X",ylab="P(x)",ylim=c(0,1.2),lwd=2)
# see breheny
library(DiceKriging)
SCAD(.1,.1)
out <- rep(NA,length(Xs))
for(i in 1:length(Xs)){
out[i] <- SCAD(Xs[i],.5)
}
lines(Xs,out,"l",lty=2,lwd=2)
mcp <- function(x,lambda){
x <- abs(x)
a <- 3.7
if(x <= a*lambda){
lambda*x - (x**2)/(2*a)
}else{
.5*a*(lambda**2)
}
}
out2 <- rep(NA,length(Xs))
for(i in 1:length(Xs)){
out2[i] <- mcp(Xs[i],.5)
}
lines(Xs,out2,"l",lty=3,lwd=2)
abline(a=0,b=0)
legend("bottomright", c("Lasso","SCAD","MCP"),lty=c(1,2,3), lwd=2,cex=.8)
mod.out <- regsem(out, type="lasso", pars_pen=c(1:9),lambda=0.2)
library(regsem)
library(regsem)
library(regsem)
101000/12
3616-2781
library(regsem)
setwd("C:/Users/RJacobucci/Documents/GitHub/mimic_regsem")
library(lavaan)
library(qgraph)
library(semPlot)
library(psych)
library(regsem)
library(lmtest)
library(ggplot2)
library(reshape2)
library(semTools)
#Here one reads in the data - As I can't share it yet I created a dummy dataset with same means and covs.
#Parameter estimates are identical down to the third decimal so for now we can just use the dummy data (for final paper just rerun with the 'real' - only difference would be skewness and nonlinearities but those are negligible)
#datacamcan<-read.csv('CamCAN_cogneuro_data_Ross2017-03-16.csv')  #Reads in real data
datacamcan<-read.csv('schmamcandat2017-03-16.csv')                #Reads in simulated data based on MVRnorm
colnames(datacamcan)[3:50]<-print(paste('gm',1:48,sep=''))        #Unify grey matter labels for easier syntax
colnames(datacamcan)[51:98]<-print(paste('fa',1:48,sep=''))       #Unify grey matter labels for easier syntax
datacamcan$simpred1<-datacamcan$VSTMcolour_K_ss3+rnorm(708,.5,.5) #add dummy predictors for reference
datacamcan$simpred2<-datacamcan$VSTMcolour_K_ss3+rnorm(708,.5,.5) #add dummy predictors for reference
#Below the syntax to fit normal ML and regsem MIMIC models to predict a single LV (vstmlv) measured by three observables
#Syntax below is to use white matter (fa) and grey matter (gm) to predict a single LV.
#Total R^2 for FA predicting vstmlv is ~38% (versus 8% with noise), and ~27% for gm
#Most exciting would be to include both of course
#############Predicting VSTM: White matter (48 ROIS)
vstmCFA_WM<-'
vstmlv=~VSTMcolour_K_ss2+VSTMcolour_K_ss3+VSTMcolour_K_ss4
vstmlv~fa 1 +fa 2 +fa 3 +fa 4 +fa 5 +fa 6 +fa 7 +fa 8 +fa 9 +fa 10 +fa 11 +fa 12 +fa 13 +fa 14 +fa 15 +fa 16 +fa 17 +fa 18 +fa 19 +fa 20 +fa 21 +fa 22 +fa 23 +fa 24 +fa 25 +fa 26 +fa 27 +fa 28 +fa 29 +fa 30 +fa 31 +fa 32 +fa 33 +fa 34 +fa 35 +fa 36 +fa 37 +fa 38 +fa 39 +fa 40 +fa 41 +fa 42 +fa 43 +fa 44 +fa 45 +fa 46 +fa 47 +fa 48
'
fitvstm_WM <- cfa(vstmCFA_WM, data=datacamcan, estimator='mlr',missing='fiml')
summary(fitvstm_WM, fit.measures=TRUE, standardized=TRUE, rsquare=TRUE)
#regsem
lav.out_WM<-try(lavaan::sem(vstmCFA_WM,datacamcan,fixed.x=TRUE,meanstructure=FALSE),silent=TRUE)
A <- extractMatrices(lav.out_WM)$A
A[A!=0]
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.002,mult.start=FALSE,
max.iter=100,solver=TRUE,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.002,mult.start=FALSE,
max.iter=100,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50))
traceback()
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.002,mult.start=FALSE,
max.iter=100,solver=FALSE,tol=1e-4,type="lasso",pars_pen=c(3:50))
lav.out_WM<-try(lavaan::sem(vstmCFA_WM,datacamcan,fixed.x=TRUE,meanstructure=TRUE),silent=TRUE)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.002,mult.start=FALSE,
max.iter=100,solver=FALSE,tol=1e-4,type="lasso",pars_pen=c(3:50))
reg.out1_WM
lav.out_WM<-try(lavaan::sem(vstmCFA_WM,datacamcan,fixed.x=TRUE,meanstructure=FALSE),silent=TRUE)
?cv_regsem
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.002,mult.start=TRUE,multi.iter=3,
max.iter=100,solver=FALSE,tol=1e-4,type="lasso",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.002,mult.start=TRUE,multi.iter=3,
max.iter=100,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.001,mult.start=TRUE,multi.iter=10,
max.iter=100,solver=FALSE,tol=1e-4,type="enet",pars_pen=c(3:50))
plot_cv(reg.out1_WM,c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.001,mult.start=TRUE,multi.iter=10,
max.iter=100,solver=FALSE,tol=1e-6,type="enet",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.001,mult.start=TRUE,multi.iter=10,
max.iter=100,solver=FALSE,tol=1e-6,type="lasso",pars_pen=c(3:50))
cor(datacamcam)
cor(datacamcan)
str(datacamcan)
colnames(datacamcan)
colnames(datacamcan[,51:98])
cor(datacamcan[,51:98])
round(cor(datacamcan[,51:98]),2)
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.001,mult.start=TRUE,multi.iter=10,
max.iter=100,solver=FALSE,tol=1e-6,type="lasso",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.001,mult.start=FALSE,multi.iter=10,
max.iter=100,solver=FALSE,tol=1e-6,type="enet",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.001,mult.start=FALSE,multi.iter=10,solver=TRUE,
max.iter=100,solver=FALSE,tol=1e-6,type="enet",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.001,mult.start=FALSE,multi.iter=10,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.001,mult.start=FALSE,multi.iter=10,solver=TRUE,
max.iter=100,tol=1e-4,type="lasso",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.001,solver=TRUE,grad="none",
max.iter=100,tol=1e-4,type="lasso",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=8,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="lasso",pars_pen=c(3:50))
plot_cv(reg.out1_WM,c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=40,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="lasso",pars_pen=c(3:50))
reg.out1_WM
plot_cv(reg.out1_WM,c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=40,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
plot_cv(reg.out1_WM,c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,block=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=2,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=20,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=20,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="lasso",pars_pen=c(3:50))
plot_cv(reg.out1_WM,c(3:50))
reg.out1_WM
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=40,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="lasso",pars_pen=c(3:50))
plot_cv(reg.out1_WM,c(3:50))
reg.out1_WM
?nlminb
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=3,jump=0.001,solver=TRUE,grad="none",
max.iter=100,tol=1e-4,type="lasso",pars_pen=c(3:50))
traceback()
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=3,jump=0.001,solver=TRUE,grad="none",
max.iter=100,tol=1e-4,type="lasso",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM
library(regsem)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
?cv_regsem
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.001,solver=TRUE,step=1,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.001,solver=TRUE,step=1,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.001,solver=TRUE,step=1,alpha=.5,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=5,jump=0.001,solver=TRUE,step=1,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=40,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=40,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
library(regsem)
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=40,jump=0.001,solver=TRUE,
max.iter=100,tol=1e-4,type="enet",pars_pen=c(3:50))
plot_cv(reg.out1_WM,c(3:50))
reg.out1_WM <- cv_regsem(lav.out_WM,n.lambda=40,jump=0.003,solver=TRUE,tol=1e-4,type="enet",pars_pen=c(3:50))
reg.out1_WM
plot_cv(reg.out1_WM,c(3:50))
library(regsem)
